[
  {
    "objectID": "transformation.html#microbiome-data",
    "href": "transformation.html#microbiome-data",
    "title": "Transformation",
    "section": "Microbiome data",
    "text": "Microbiome data\n\nHigh variability ‚Äî feature abundances vary widely across samples\nZero-inflation ‚Äî many taxa absent in most samples\nCompositionality ‚Äî only relative abundances observed; total counts per sample are arbitrary\n\n\n\nHigh variability ‚Üí lots of variation in abundances\nZero-inflation ‚Üí many features are absent in most samples, which complicates statistical modelling and increases sparsity of the data matrix.\nCompositionality ‚Üí sequencing depth differs between samples; only ratios of features within a sample are meaningful, absolute counts are not."
  },
  {
    "objectID": "transformation.html#heteroscedasticity",
    "href": "transformation.html#heteroscedasticity",
    "title": "Transformation",
    "section": "Heteroscedasticity",
    "text": "Heteroscedasticity\n\n\nheteroscedasticity: the variance increases more than the mean. Abundant taxa have lots of variability."
  },
  {
    "objectID": "transformation.html#zero-inflation",
    "href": "transformation.html#zero-inflation",
    "title": "Transformation",
    "section": "Zero-inflation",
    "text": "Zero-inflation\n\n\nReal microbiome data. Lots of zeroes."
  },
  {
    "objectID": "transformation.html#compositionality",
    "href": "transformation.html#compositionality",
    "title": "Transformation",
    "section": "Compositionality",
    "text": "Compositionality\n\nSequencing measures relative abundances, not true microbial counts\nValues are parts of a whole\nParts are linked by a fixed total (library size)\n\nIf one increases, at least one other must decrease\n\n\n\nSequencing does not measure the true number of bacteria in a sample. Each sample produces an arbitrary total number of reads (library size) due to technical variation and bias.\nBecause all microbes share this fixed total, we observe only relative abundances, not absolute quantities.\nMost standard statistical methods assume variables can change independently. Compositional data violate this assumption: all values must sum to the same total, so changes are always relative.\nIgnoring this constraint can lead to misleading results, even when the data look reasonable.\nEveryday examples of compositional data include: - A budget - How you spend 24 hours in a day (more work means less time for something else)"
  },
  {
    "objectID": "transformation.html#section",
    "href": "transformation.html#section",
    "title": "Transformation",
    "section": "",
    "text": "These plots show the same two samples in two different ways.\nOn the left, we see absolute counts. Taxon A increases in Sample 2, while taxa B and C stay exactly the same.\nOn the right, we see relative abundances, which is what sequencing gives us. Because each sample has a fixed library size, all taxa must share the same total.\nAs taxon A takes up a larger share in Sample 2, the proportions of B and C go down ‚Äî even though their true counts did not change.\nThis is compositional bias: changes in one taxon can make others appear to change simply because everything is expressed as proportions."
  },
  {
    "objectID": "transformation.html#goals-of-transformation",
    "href": "transformation.html#goals-of-transformation",
    "title": "Transformation",
    "section": "Goals of transformation",
    "text": "Goals of transformation\n\nMitigate biases in abundances\nMake features comparable across samples\nMeet assumptions of downstream statistical analyses\n\n\n\nTransformations allow standard analyses like PCA, regression, correlation.\nChoose transformation depending on the problem: relative abundance, log, CLR, etc."
  },
  {
    "objectID": "transformation.html#relative-abundance",
    "href": "transformation.html#relative-abundance",
    "title": "Transformation",
    "section": "Relative abundance",
    "text": "Relative abundance\n\nLibrary sizes are arbitrary\n\n\\[\n\\text{X}_{ij} = \\frac{\\text{Count}_{ij}}{\\sum_{k=1}^m \\text{Count}_{ik}}\n\\]\nwhere\n\n\\(i\\) indexes the sample,\n\\(j\\) indexes the taxon,\n\\(m\\) is the total number of taxa.\n\n\nLibrary sizes were arbitrary ‚Äì&gt; remove their effect.\n\nLibrary sizes differ between samples (sequencing depth varies), so raw counts are not directly comparable.\nRelative abundance converts counts to proportions within each sample, making samples comparable.\nIntuition: a relative abundance of 0.2 means ‚Äúthis taxon makes up 20% of this sample,‚Äù independent of total reads."
  },
  {
    "objectID": "transformation.html#log-transformed-relative-abundance",
    "href": "transformation.html#log-transformed-relative-abundance",
    "title": "Transformation",
    "section": "Log-transformed relative abundance",
    "text": "Log-transformed relative abundance\n\nLibrary sizes are arbitrary and data zero-inflated\n\n\\[\n\\text{X}_{ij} = \\log \\left( \\text{Relative abundance}_{ij} + \\epsilon \\right)\n\\]\nwhere\n\n\\(\\epsilon\\) is a small pseudocount to avoid \\(\\log(0)\\).\n\n\nZero-inflated ‚Äì&gt; reduce the data skewness\nLog-transform reduces skewness and makes differences among low-abundance taxa more visible, but a pseudocount is required to handle zeros."
  },
  {
    "objectID": "transformation.html#section-2",
    "href": "transformation.html#section-2",
    "title": "Transformation",
    "section": "",
    "text": "The data is still constrained to relative abundances (0-1), but now in log-scale.\nBecause the total is fixed, the numbers depend on each other.\nIf one goes up, at least one of the others must go down. This is called a constraint."
  },
  {
    "objectID": "transformation.html#centered-log-ratio-clr",
    "href": "transformation.html#centered-log-ratio-clr",
    "title": "Transformation",
    "section": "Centered log-ratio (CLR)",
    "text": "Centered log-ratio (CLR)\n\nLibrary sizes are arbitrary and values are dependent\n\n\\[\n\\text{CLR}(x_i) = \\log\\left(\\frac{x_i}{g(x)}\\right),\\quad\ng(x) = \\left(\\prod_{j=1}^{D} x_j \\right)^{1/D}\n\\]\n\n\\(x_i\\): abundance of bacteria \\(i\\)\n\n\\(g(x)\\): geometric mean across all bacteria in the sample\n\n\nCLR is a standard transformation for compositional data. It accounts for dependency between parts and arbitrary library sizes, which simple relative abundance transformations cannot."
  },
  {
    "objectID": "transformation.html#section-3",
    "href": "transformation.html#section-3",
    "title": "Transformation",
    "section": "",
    "text": "Centering means that we subtract mean from each value to get the distribution centered to 0. Because we use log-scale, we have to use suitable mean (geometric mean aka arithmetic mean in log-scale)."
  },
  {
    "objectID": "transformation.html#section-4",
    "href": "transformation.html#section-4",
    "title": "Transformation",
    "section": "",
    "text": "\\[\n\\text{Arithmetic mean} = \\frac{2 + 8 + 32}{3} = \\frac{42}{3} = 14\n\\]\n\\[\n\\text{Geometric mean} = \\sqrt[3]{2 \\cdot 8 \\cdot 32} \\\\[2mm]\n= \\exp\\Bigg( \\frac{\\log 2 + \\log 8 + \\log 32}{3} \\Bigg) \\\\[2mm]\n= 8\n\\]\n\nThe geometric mean is just the arithmetic mean in log-space. Because now the values are in logarithmic space, we have to use geometric mean."
  },
  {
    "objectID": "transformation.html#centered-log-ratio-clr-1",
    "href": "transformation.html#centered-log-ratio-clr-1",
    "title": "Transformation",
    "section": "Centered log-ratio (CLR)",
    "text": "Centered log-ratio (CLR)\n\\[\n\\text{CLR}(x_i) \\;=\\; \\log\\left(\\frac{x_i}{g(x)}\\right) \\\\[2mm]\n= \\log(x_i) - \\log(g(x)) \\\\[2mm]\n= \\log(x_i) - \\frac{1}{D}\\sum_{j=1}^{D}\\log(x_j)\n\\]\n\n\nTake a logarithm of the values ‚Äì&gt; ratios become subtraction which is what we want in Euclidean space\nCenter values to mean 0\nCLR values show how each feature compares to the sample‚Äôs geometric mean.\nPositive = enriched, Negative = depleted.\nMagnitude gives a fold-change interpretation on a log scale."
  },
  {
    "objectID": "transformation.html#interpretation",
    "href": "transformation.html#interpretation",
    "title": "Transformation",
    "section": "Interpretation:",
    "text": "Interpretation:\n\nPositive CLR ‚Üí feature is more abundant than the sample‚Äôs average\nNegative CLR ‚Üí feature is less abundant than the sample‚Äôs average\nMagnitude ‚Üí how strongly the feature deviates from the average\n\nOn a log scale: CLR = 1 ‚Üí ~2.7√ó average\nCLR = 2 ‚Üí ~7.4√ó average\nCLR = ‚àí1 ‚Üí ~0.37√ó average\n\n\n\n\nCLR values show how each feature compares to the sample‚Äôs geometric mean.\nPositive = enriched, Negative = depleted.\nMagnitude gives a fold-change interpretation on a log scale."
  },
  {
    "objectID": "transformation.html#centered-log-ratio-clr-2",
    "href": "transformation.html#centered-log-ratio-clr-2",
    "title": "Transformation",
    "section": "Centered log-ratio (CLR)",
    "text": "Centered log-ratio (CLR)\n\nRemoves compositional constraints (constant sum)\nValues centered around zero, symmetric\nAllows standard statistical tools (PCA, correlations)\nDebate on whether it is necessary in DA\n\n\n\nCLR is widely used in microbiome data analysis because it removes compositional constraints and often makes data more normally distributed.\nHowever, recent benchmark studies highlight some limitations in differential abundance (DA) analysis:\n\nCan lack sensitivity\nMay produce paradoxical results in low-diversity microbiomes\n\nCLR values are harder to interpret than relative abundances because each value is dependent on the other features in the sample\n\nDespite this, CLR remains a standard, especially for methods that assume Euclidean space."
  },
  {
    "objectID": "transformation.html#section-5",
    "href": "transformation.html#section-5",
    "title": "Transformation",
    "section": "",
    "text": "Makes the data more normally distributed. Distributed around zero. Without constrains (goes from negative infinity to positive)"
  },
  {
    "objectID": "transformation.html#demonstration",
    "href": "transformation.html#demonstration",
    "title": "Transformation",
    "section": "Demonstration",
    "text": "Demonstration\nlibrary(mia)\n\ntse &lt;- transformAssay(tse, method = \"relabundance\")\nprint(tse)\n\n\nclass: TreeSummarizedExperiment \ndim: 19216 26 \nmetadata(0):\nassays(2): counts relabundance\nrownames(19216): 549322 522457 ... 200359 271582\nrowData names(7): Kingdom Phylum ... Genus Species\ncolnames(26): CL3 CC1 ... Even2 Even3\ncolData names(7): X.SampleID Primer ... SampleType Description\nreducedDimNames(0):\nmainExpName: NULL\naltExpNames(0):\nrowLinks: a LinkDataFrame (19216 rows)\nrowTree: 1 phylo tree(s) (19216 leaves)\ncolLinks: NULL\ncolTree: NULL"
  },
  {
    "objectID": "transformation.html#exercises",
    "href": "transformation.html#exercises",
    "title": "Transformation",
    "section": "Exercises",
    "text": "Exercises\nFrom OMA online book, Chapter 12: Transformation\n\nAll exercises"
  },
  {
    "objectID": "transformation.html#references",
    "href": "transformation.html#references",
    "title": "Transformation",
    "section": "References",
    "text": "References\n\n\n\n\nhttps://microbiome.github.io/"
  },
  {
    "objectID": "miasim.html#microbiome-data-simulation-with-miasim",
    "href": "miasim.html#microbiome-data-simulation-with-miasim",
    "title": "miaSim",
    "section": "Microbiome data simulation with miaSim",
    "text": "Microbiome data simulation with miaSim\n\nR/Bioconductor package for simulating microbial community dynamics\nCommon ecological models\nmiaSimShiny: Graphical user interface\n\n\nCommon ecological models used in microbiome research"
  },
  {
    "objectID": "miasim.html#implemented-models",
    "href": "miasim.html#implemented-models",
    "title": "miaSim",
    "section": "Implemented models",
    "text": "Implemented models\n\nSelf-organised instability (SOI)\nHubbell‚Äôs neutral model\nGeneralized Lotka‚ÄìVolterra (gLV)\nRicker model (discrete gLV)\nStochastic logistic model\nConsumer‚Äìresource model"
  },
  {
    "objectID": "miasim.html#stochastic-logistic-model",
    "href": "miasim.html#stochastic-logistic-model",
    "title": "miaSim",
    "section": "Stochastic logistic model",
    "text": "Stochastic logistic model\n\\[\n\\frac{dN}{dt} = r N \\left(1 - \\frac{N}{K}\\right) + \\sigma N \\, \\eta(t)\n\\]\n\n\\(N\\): population size\n\n\\(r\\): intrinsic growth rate\n\n\\(K\\): carrying capacity\n\n\\(\\sigma\\): noise strength\n\n\\(\\eta(t)\\): random fluctuation (white noise)"
  },
  {
    "objectID": "miasim.html#logistic-growth-deterministic",
    "href": "miasim.html#logistic-growth-deterministic",
    "title": "miaSim",
    "section": "Logistic growth (deterministic)",
    "text": "Logistic growth (deterministic)\n\n\n\\[\n\\frac{dN}{dt} = rN\\!\\left(1 - \\frac{N}{K}\\right)\n\\]\n\n\\(N\\): population size\n\\(r\\): intrinsic growth rate\n\\(K\\): carrying capacity\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nClassic S-shaped growth; growth slows as (N K). Simple, interpretable, widely known.\n\n(r): speed to grow when rare\n\n(K): long-term typical size (without noise)\n\nHigher (r) ‚Üí faster approach to (K)."
  },
  {
    "objectID": "miasim.html#add-randomness-stochastic-logistic-model",
    "href": "miasim.html#add-randomness-stochastic-logistic-model",
    "title": "miaSim",
    "section": "Add randomness ‚Üí Stochastic logistic model",
    "text": "Add randomness ‚Üí Stochastic logistic model\n\n\n\\[\n\\frac{dN}{dt} = rN\\!\\left(1 - \\frac{N}{K}\\right) + \\sigma N\\,\\eta(t)\n\\]\n\n\\(\\sigma\\): noise strength\n\\(\\eta(t)\\): random fluctuation (white noise)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nJust one extra component: multiplicative noise. Captures environmental/host variability or demographic stochasticity. Population fluctuates around (K) rather than following a perfect curve.\n\n(): strength of fluctuations around (K) Higher () ‚Üí larger variance around (K); occasional dips/spikes."
  },
  {
    "objectID": "miasim.html#stochastic-logistic-model-1",
    "href": "miasim.html#stochastic-logistic-model-1",
    "title": "miaSim",
    "section": "Stochastic logistic model",
    "text": "Stochastic logistic model\n\nSingle-species microbial dynamics under resource limits\nEffects of random perturbations (e.g., host variability)\nBenchmark for statistical methods before multi-species models\n\n\nCan be used to model single-species dynamics, effects of random perturbations and as a most simple model.\nSimple model. No interactions between microbes.\nEach species can be simulated separately with its own parameters, independently.\nProvides a baseline for comparison with more complex community models."
  },
  {
    "objectID": "miasim.html#learn-more",
    "href": "miasim.html#learn-more",
    "title": "miaSim",
    "section": "Learn more",
    "text": "Learn more\n\n\n\n\n\n\n\n\n\n\n\nmiaSim package vignette (tutorials, examples, and model descriptions)\n\n\n\n\n\n\n\n\n\n\n(Gao et al. 2023) (publication)"
  },
  {
    "objectID": "miasim.html#references",
    "href": "miasim.html#references",
    "title": "miaSim",
    "section": "References",
    "text": "References\n\n\n\n\nhttps://microbiome.github.io/\n\n\n\n\nGao, Yu, Yaƒümur ≈ûim≈üek, Emma Gheysen, Tuomas Borman, Yi Li, Leo Lahti, Karoline Faust, and Daniel Rios Garza. 2023. ‚ÄúmiaSim: An R/Bioconductor Package to Easily Simulate Microbial Community Dynamics.‚Äù Methods in Ecology and Evolution 14 (8): 1967‚Äì80. https://doi.org/10.1111/2041-210x.14129."
  },
  {
    "objectID": "alpha_diversity.html#alpha-diversity",
    "href": "alpha_diversity.html#alpha-diversity",
    "title": "Alpha diversity",
    "section": "Alpha diversity",
    "text": "Alpha diversity\nMeasures diversity within a single sample\nCaptures two key aspects:\n\nRichness: how many unique species are present\n\nEvenness: how evenly distributed they are\n\n\n\nAlpha diversity summarizes microbial diversity in a single number per sample.\n\nRichness = count of unique species (or taxa);\nEvenness = balance of abundances; opposite to dominance\n\nUseful for comparing samples, understanding ecological structure, and detecting dysbiosis."
  },
  {
    "objectID": "alpha_diversity.html#section",
    "href": "alpha_diversity.html#section",
    "title": "Alpha diversity",
    "section": "",
    "text": "Each circle represents a sample.\n\nPoint color = species identity.\nHigh richness = more colors present.\nHigh evenness = similar number of points per species.\nLow evenness = dominance by one species."
  },
  {
    "objectID": "alpha_diversity.html#richness",
    "href": "alpha_diversity.html#richness",
    "title": "Alpha diversity",
    "section": "Richness",
    "text": "Richness\n\\[\nR = \\text{Number of unique species}\n\\]\n\nObserved richness is the simplest diversity metric.\nIt tells how many unique species can be directly observed in a sample.\n\nObserved richness\n\nobserved richness: counting the number of unique species\n\nTrue richness to be estimated based on a finite sample (Sanders, 1968).\n\nChao1: is more sensitive to sampling effort\nACE: more stable, emphasizes information from rare taxa"
  },
  {
    "objectID": "alpha_diversity.html#simpsons-evenness",
    "href": "alpha_diversity.html#simpsons-evenness",
    "title": "Alpha diversity",
    "section": "Simpson‚Äôs evenness",
    "text": "Simpson‚Äôs evenness\n\\[\nE_{\\mathrm{Simpson}} = \\frac{1}{S \\sum_{i=1}^{S} p_i^2}\n\\]\nwhere:\n\n\\(p_i\\) = relative abundance of taxon \\(i\\)\n\n\\(S\\) = number of taxa\nBounded between 0 (low evenness) and 1 (perfectly even)\n\n\nSimpson‚Äôs evenness measures how evenly individuals are distributed among taxa.\nIt is easy to interpret and always ranges between 0 and 1."
  },
  {
    "objectID": "alpha_diversity.html#shannon-diversity",
    "href": "alpha_diversity.html#shannon-diversity",
    "title": "Alpha diversity",
    "section": "Shannon diversity",
    "text": "Shannon diversity\n\\[\nH' = - \\sum_{i=1}^{R} p_i \\log(p_i)\n\\]\nwhere:\n\n\\(p_i\\) = relative abundance of species \\(i\\)\n\n\\(R\\) = total number of species\n\nCombines richness and evenness in one metric.\n\nShannon diversity is another common diversity index.\nLike Simpson, It accounts for both richness and evenness.\n\nHigher values mean more diverse communities. (Value can be over 1, no upper bound)\nTrue richness: exp(H) (how many species with equal abundance will give that diversity)"
  },
  {
    "objectID": "alpha_diversity.html#recommendation",
    "href": "alpha_diversity.html#recommendation",
    "title": "Alpha diversity",
    "section": "Recommendation",
    "text": "Recommendation\nGuidelines for alpha diversity, to capture complementary views: Cassol, Iba√±ez, and Bustamante (2025)\n\nRichness: number of observed unique species\nDominance: Berger-Parker\nInformation: Shannon\nPhylogenetics: Faith\n\n\nRecommended to analyse and report all aspects.\nDominance captures evenness (with inverse direction)\n\n\nChages in alpha diversity are associated with health outcome."
  },
  {
    "objectID": "alpha_diversity.html#section-1",
    "href": "alpha_diversity.html#section-1",
    "title": "Alpha diversity",
    "section": "",
    "text": "library(mia)\ntse &lt;- addAlpha(tse)"
  },
  {
    "objectID": "alpha_diversity.html#demonstration",
    "href": "alpha_diversity.html#demonstration",
    "title": "Alpha diversity",
    "section": "Demonstration",
    "text": "Demonstration"
  },
  {
    "objectID": "alpha_diversity.html#section-2",
    "href": "alpha_diversity.html#section-2",
    "title": "Alpha diversity",
    "section": "",
    "text": "library(mia)\ntse &lt;- addAlpha(tse)\n\nlibrary(miaViz)\nplotBoxplot(tse, col.var = \"faith_diversity\", x = \"patient_status\") +\n    labs(x = \"Diagnosis\", y = \"Faith's diversity\")"
  },
  {
    "objectID": "alpha_diversity.html#section-3",
    "href": "alpha_diversity.html#section-3",
    "title": "Alpha diversity",
    "section": "",
    "text": "Cassol, Ignacio, Mauro Iba√±ez, and Juan Pablo Bustamante. 2025. ‚ÄúKey Features and Guidelines for the Application of Microbial Alpha Diversity Metrics.‚Äù Scientific Reports 15 (1). https://doi.org/10.1038/s41598-024-77864-y."
  },
  {
    "objectID": "alpha_diversity.html#exercises",
    "href": "alpha_diversity.html#exercises",
    "title": "Alpha diversity",
    "section": "Exercises",
    "text": "Exercises\nFrom OMA online book, Chapter 14: Alpha diversity\n\n1.2, 1.3, 1.4, 1.9, 1.10"
  },
  {
    "objectID": "alpha_diversity.html#references",
    "href": "alpha_diversity.html#references",
    "title": "Alpha diversity",
    "section": "References",
    "text": "References"
  },
  {
    "objectID": "multi-omics.html#multi-omics-integration",
    "href": "multi-omics.html#multi-omics-integration",
    "title": "Multi-omics",
    "section": "Multi-omics integration",
    "text": "Multi-omics integration\n\nIntegrate multiple omics layers: microbiome, metabolome, transcriptome, etc.\nExplore associations and predict outcomes\nGain complementary insights that single-omics cannot provide\n\n\nmulti-omics provides complementary information. The goal is to combine them effectively."
  },
  {
    "objectID": "multi-omics.html#data-containers",
    "href": "multi-omics.html#data-containers",
    "title": "Multi-omics",
    "section": "Data containers",
    "text": "Data containers\n\naltExp() slot in TreeSummarizedExperiment\nMultiAssayExperiment\n\n\nUsing well-defined containers makes multi-omics workflows reproducible and interoperable."
  },
  {
    "objectID": "multi-omics.html#methods",
    "href": "multi-omics.html#methods",
    "title": "Multi-omics",
    "section": "Methods",
    "text": "Methods\n\nAssociation: detect cross-omics correlations\nOrdination: reduce dimensionality, e.g., MOFA2\nSupervised machine learning: predict outcomes, e.g., IntegratedLearner\n\n\nCurrent approaches can be divided into these."
  },
  {
    "objectID": "multi-omics.html#cross-association",
    "href": "multi-omics.html#cross-association",
    "title": "Multi-omics",
    "section": "Cross-association",
    "text": "Cross-association\n\nCLR + Spearman \n\n\n\nThis heatmap visualizes cross-omics correlations after CLR normalization."
  },
  {
    "objectID": "multi-omics.html#pearson-correlation",
    "href": "multi-omics.html#pearson-correlation",
    "title": "Multi-omics",
    "section": "Pearson correlation",
    "text": "Pearson correlation\n\nMeasures linear association between two features\nSpearman correlation = Pearson correlation on ranks\n\n\\[\nr = \\frac{\n  \\underbrace{\\sum_{i=1}^{n} (x_i - \\bar{x})(y_i - \\bar{y})}_{\\text{numerator: covariance}}\n}{\n  \\underbrace{\\sqrt{\\sum_{i=1}^{n} (x_i - \\bar{x})^2} \\;\\; \\sqrt{\\sum_{i=1}^{n} (y_i - \\bar{y})^2}}_{\\text{denominator: product of standard deviations}}\n}\n\\]\n\nNumerator: measures co-variation of features. Denominator: scales by standard deviations to get a normalized correlation coefficient between -1 and 1."
  },
  {
    "objectID": "multi-omics.html#calculating-targeted-correlations",
    "href": "multi-omics.html#calculating-targeted-correlations",
    "title": "Multi-omics",
    "section": "Calculating ‚Äútargeted‚Äù correlations",
    "text": "Calculating ‚Äútargeted‚Äù correlations\n\nFocus on feature pairs with found relationships\nAvoids computing all pairwise correlations\nImplemented in anansi"
  },
  {
    "objectID": "multi-omics.html#ordination",
    "href": "multi-omics.html#ordination",
    "title": "Multi-omics",
    "section": "Ordination",
    "text": "Ordination\nMulti-omics Factor Analysis (MOFA2)\n\nFactorizes multi-omics matrix into latent factors\nCaptures shared and data-specific variation across omics\nOutputs low-dimensional embeddings for samples and features\n\n\nMOFA2 is a popular unsupervised multi-omics ordination method. Latent factors can be used for visualization or downstream analyses."
  },
  {
    "objectID": "multi-omics.html#supervised-ml",
    "href": "multi-omics.html#supervised-ml",
    "title": "Multi-omics",
    "section": "Supervised ML",
    "text": "Supervised ML\nIntegratedLearner\n\nPredict phenotypes from multiple omics\nEnsemble learning combining base learners per omics\n\n\nIntegratedLearner is suitable for multi-omics prediction tasks, combining results from each data layer efficiently."
  },
  {
    "objectID": "multi-omics.html#demonstration",
    "href": "multi-omics.html#demonstration",
    "title": "Multi-omics",
    "section": "Demonstration",
    "text": "Demonstration"
  },
  {
    "objectID": "multi-omics.html#section",
    "href": "multi-omics.html#section",
    "title": "Multi-omics",
    "section": "",
    "text": "library(mia)\nlibrary(pheatmap)\n\n# Calculate correlations\nmat &lt;- getCrossAssociation(\n  mae, assay.type1 = \"rclr\", experiment2 = 3, \n  assay.type2 = \"signals\", mode = \"matrix\"\n)"
  },
  {
    "objectID": "multi-omics.html#section-1",
    "href": "multi-omics.html#section-1",
    "title": "Multi-omics",
    "section": "",
    "text": "library(mia)\nlibrary(pheatmap)\n\n# Calculate correlations\nmat &lt;- getCrossAssociation(\n  mae, assay.type1 = \"rclr\", experiment2 = 3, \n  assay.type2 = \"signals\", mode = \"matrix\"\n)\n# Visualize\npheatmap(mat)\n\n\nThis heatmap visualizes cross-omics correlations after CLR normalization."
  },
  {
    "objectID": "multi-omics.html#exercises",
    "href": "multi-omics.html#exercises",
    "title": "Multi-omics",
    "section": "Exercises",
    "text": "Exercises\nFrom OMA online book, Chapter 23: Cross-association\n\nAll exercises"
  },
  {
    "objectID": "multi-omics.html#references",
    "href": "multi-omics.html#references",
    "title": "Multi-omics",
    "section": "References",
    "text": "References\n\n\n\n\nhttps://microbiome.github.io/"
  },
  {
    "objectID": "outro.html#questions",
    "href": "outro.html#questions",
    "title": "Outro",
    "section": "Questions",
    "text": "Questions\n\nWhat are mia and OMA?\nHow microbiome data science is conducted in SummarizedExperiment ecosystem?\nWhat benefits this new ecosystem have compared to previous approaches?\n\n\nGo through the questions"
  },
  {
    "objectID": "outro.html#objectives",
    "href": "outro.html#objectives",
    "title": "Outro",
    "section": "Objectives",
    "text": "Objectives\n\nAnalyze microbiome data using the SummarizedExperiment ecosystem\n\nCreate & interpret visualizations\n\nExplore documentation & tools via the OMA book\n\n\nThese were the objectives. You think you can now continue with the ecosystem?"
  },
  {
    "objectID": "outro.html#contact-info",
    "href": "outro.html#contact-info",
    "title": "Outro",
    "section": "Contact info",
    "text": "Contact info\n\nemail: tvborm@utu.fi\ngithub.com/microbiome/OMA/discussions\ncommunity-bioc.zulipchat.com\n\n\n\nFeel free to reach me and others."
  },
  {
    "objectID": "outro.html#feedback",
    "href": "outro.html#feedback",
    "title": "Outro",
    "section": "Feedback",
    "text": "Feedback\n\nhttps://forms.gle/quHvP9YSQXcLixKs7\nFeedback helps us to improve the ecosystem and workshop. COMMUNITY of users and deverlopers"
  },
  {
    "objectID": "outro.html#thank-you-for-participating",
    "href": "outro.html#thank-you-for-participating",
    "title": "Outro",
    "section": "Thank you for participating!",
    "text": "Thank you for participating!"
  },
  {
    "objectID": "outro.html#references",
    "href": "outro.html#references",
    "title": "Outro",
    "section": "References",
    "text": "References\n\n\n\n\nhttps://microbiome.github.io/"
  },
  {
    "objectID": "daa.html#differential-abundance-analysis-daa",
    "href": "daa.html#differential-abundance-analysis-daa",
    "title": "Differential abundance analysis (DAA)",
    "section": "Differential abundance analysis (DAA)",
    "text": "Differential abundance analysis (DAA)\n\nGoal: identify taxa with different abundance between groups\nApproaches:\n\nClassical statistical tests\nMicrobiome-specific methods\n\nChallenges: compositionality, sparsity, multiple testing\n\n\nDAA is central in microbiome studies, but requires caution due to unique properties of sequencing data."
  },
  {
    "objectID": "daa.html#elementary-methods-provide-more-replicable-results-in-microbial-differential-abundance-analysis",
    "href": "daa.html#elementary-methods-provide-more-replicable-results-in-microbial-differential-abundance-analysis",
    "title": "Differential abundance analysis (DAA)",
    "section": "Elementary methods provide more replicable results in microbial differential abundance analysis",
    "text": "Elementary methods provide more replicable results in microbial differential abundance analysis\n\nRelative abundances with a Wilcoxon test\nLog-transformed relative abundances with a t-test\nPresence/absence of taxa with logistic regression\n\nPelto et al.¬†2025 show that simple methods often give more replicable results.\n\nInstead of complex pipelines, simple classical tests may be more reproducible across studies."
  },
  {
    "objectID": "daa.html#classical-tests-are-linear-models",
    "href": "daa.html#classical-tests-are-linear-models",
    "title": "Differential abundance analysis (DAA)",
    "section": "Classical tests are linear models",
    "text": "Classical tests are linear models\n\nRelative abundances with a Wilcoxon test\n\nNon-parametric, but can be expressed as a rank-based linear model\n\n\n\\[\n\\mathrm{Rank}(\\mathrm{Relative\\ abundance}) \\sim \\mathrm{Group}\n\\]\n\nLog-transformed relative abundances with a t-test\n\nStandard linear model\n\n\n\\[\n\\log(\\mathrm{Relative\\ abundance}) \\sim \\mathrm{Group}\n\\]\n\nPresence/absence of taxa with logistic regression\n\nGeneralized linear model with logit link\n\n\n\\[\n\\mathrm{Presence} \\sim \\mathrm{Group}, \\quad \\mathrm{Presence} \\in \\{0,1\\}\n\\]\n\nInstead of complex pipelines, simple classical tests may be more reproducible across studies."
  },
  {
    "objectID": "daa.html#wilcoxon-vs-t-test",
    "href": "daa.html#wilcoxon-vs-t-test",
    "title": "Differential abundance analysis (DAA)",
    "section": "Wilcoxon vs t-test",
    "text": "Wilcoxon vs t-test\n\nWilcoxon: compares medians, robust to outliers, non-parametric\nt-test: compares means, assumes normality, sensitive to outliers\n\n\n\nThis plot illustrates how outliers affect the t-test but not the Wilcoxon test. Blue line = mean, red line = median."
  },
  {
    "objectID": "daa.html#demonstration",
    "href": "daa.html#demonstration",
    "title": "Differential abundance analysis (DAA)",
    "section": "Demonstration",
    "text": "Demonstration"
  },
  {
    "objectID": "daa.html#section",
    "href": "daa.html#section",
    "title": "Differential abundance analysis (DAA)",
    "section": "",
    "text": "library(maaslin3)\n\nmaaslin3_out &lt;- maaslin3(\n    input_data = tse,\n    formula = \"~ patient_status\",\n    normalization = \"TSS\",\n    transform = \"LOG\",\n)"
  },
  {
    "objectID": "daa.html#exercises",
    "href": "daa.html#exercises",
    "title": "Differential abundance analysis (DAA)",
    "section": "Exercises",
    "text": "Exercises\nFrom OMA online book, Chapter 17: Differential abundance\n\nAll exercises"
  },
  {
    "objectID": "daa.html#references",
    "href": "daa.html#references",
    "title": "Differential abundance analysis (DAA)",
    "section": "References",
    "text": "References\n\n\n\n\nhttps://microbiome.github.io/"
  },
  {
    "objectID": "reproducible_reporting.html#reproducible-reporting",
    "href": "reproducible_reporting.html#reproducible-reporting",
    "title": "Reproducible reporting",
    "section": "Reproducible reporting",
    "text": "Reproducible reporting\n\nTo create human-readable reports\nTransparency, reusability and reproducibility\nDebugging\n\n\nIn microbiome research, workflows often involve many custom scripts and datasets. Standardized, reproducible reporting ensures results can be verified, reused, and built upon."
  },
  {
    "objectID": "reproducible_reporting.html#literate-programming",
    "href": "reproducible_reporting.html#literate-programming",
    "title": "Reproducible reporting",
    "section": "Literate programming",
    "text": "Literate programming\nProgramming paradigm introduced by Donald Knuth (1984) in which a computer program is given as an explanation of its logic in a natural language, embedded with code chunks, from which compilable source code can be generated.\n(Adapted from Wikipedia)\n\n\nLiterate programming emphasizes writing code for humans first, allowing the logic to be explained clearly, with the computer code embedded for execution."
  },
  {
    "objectID": "reproducible_reporting.html#reproducible-notebooks",
    "href": "reproducible_reporting.html#reproducible-notebooks",
    "title": "Reproducible reporting",
    "section": "Reproducible notebooks",
    "text": "Reproducible notebooks\n\nWe use Quarto for reproducible documentation.\nNext generation development of Rmarkdown\nSupported by RStudio\n\n\nQuarto allows combining narrative, code, and results in a single reproducible document, ideal for microbiome workflows.\nYou can do slides, book, websites, ‚Ä¶\nCompared to RMarkdown, better support for other langauges. You can use SQL, Python and Julia along with R in same document."
  },
  {
    "objectID": "reproducible_reporting.html#demonstration",
    "href": "reproducible_reporting.html#demonstration",
    "title": "Reproducible reporting",
    "section": "Demonstration",
    "text": "Demonstration\n\nShow how to open file in RStudio.\nWhat are code chunks and how to write text.\nHow to render?"
  },
  {
    "objectID": "reproducible_reporting.html#exercises",
    "href": "reproducible_reporting.html#exercises",
    "title": "Reproducible reporting",
    "section": "Exercises",
    "text": "Exercises\nFrom OMA online book, Chapter 1: Microbiome data science in Bioconductor\nmicrobiome.github.io/OMA/docs/devel/pages/intro.html\n\nExercise 2\nExercise 3\nExercise 4"
  },
  {
    "objectID": "reproducible_reporting.html#references",
    "href": "reproducible_reporting.html#references",
    "title": "Reproducible reporting",
    "section": "References",
    "text": "References\n\n\n\n\nhttps://microbiome.github.io/"
  },
  {
    "objectID": "machine_learning.html#demonstration",
    "href": "machine_learning.html#demonstration",
    "title": "Machine learning (ML)",
    "section": "Demonstration",
    "text": "Demonstration"
  },
  {
    "objectID": "machine_learning.html#exercises",
    "href": "machine_learning.html#exercises",
    "title": "Machine learning (ML)",
    "section": "Exercises",
    "text": "Exercises"
  },
  {
    "objectID": "machine_learning.html#references",
    "href": "machine_learning.html#references",
    "title": "Machine learning (ML)",
    "section": "References",
    "text": "References\n\n\n\n\nhttps://microbiome.github.io/"
  },
  {
    "objectID": "beta_diversity.html#beta-diversity",
    "href": "beta_diversity.html#beta-diversity",
    "title": "Beta diversity",
    "section": "Beta diversity",
    "text": "Beta diversity\n\nSimilarity between samples\nDissimilarity/distance between samples, clustering, ordination‚Ä¶\nIdentify patterns of community variation across conditions or treatments\n\n\nUmbrella term. Different methods. Goal is to identify patterns from microbial profiles."
  },
  {
    "objectID": "beta_diversity.html#ordination",
    "href": "beta_diversity.html#ordination",
    "title": "Beta diversity",
    "section": "Ordination",
    "text": "Ordination\n\nOrdination"
  },
  {
    "objectID": "beta_diversity.html#references",
    "href": "beta_diversity.html#references",
    "title": "Beta diversity",
    "section": "References",
    "text": "References\n\n\n\n\nhttps://microbiome.github.io/"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Quarto presentations",
    "section": "",
    "text": "This website hosts quarto presentations about microbiome analysis and data integration with mia and other related packages. Our presentations were prepared for past courses and conferences and cover a broad range of topics in the scope of biological data science. Currently, you can find the following subjects:"
  },
  {
    "objectID": "index.html#overview",
    "href": "index.html#overview",
    "title": "Quarto presentations",
    "section": "",
    "text": "This website hosts quarto presentations about microbiome analysis and data integration with mia and other related packages. Our presentations were prepared for past courses and conferences and cover a broad range of topics in the scope of biological data science. Currently, you can find the following subjects:"
  },
  {
    "objectID": "index.html#topics",
    "href": "index.html#topics",
    "title": "Quarto presentations",
    "section": "Topics",
    "text": "Topics\n\nIntroduction\n\nBioconductor\nReproducible reporting\nData containers\nImport data\n\nPreprocessing\n\nAgglomeration\nTransformation\n\nDiversity\n\nAlpha diversity\nBeta diversity\n\nOrdination\n\n\nAssociation\n\nDifferential abundance analysis\nFunctional analysis\n\nMulti-omics\n\nMulti-omics\n\nMachine learning\n\nMachine learning\n\n\n\nPackages\n\nMGnifyR: An R package for accessing MGnify microbiome data\nmiaDash: Microbiome Analysis Dashboard\nmiaSim: Microbiome simulation\n\n\n\nData sets\n\nHintikkaXO\nTengeler2020\n\n\n\nConference and seminar presentations\n\nOrchestrating microbiome multi-omics (BioC2023)\nOrchestrating Microbiome Analysis with Bioconductor (OH-BOOST, Microbiota Data Analysis and Statistics, webinar)\nOrchestrating Microbiome Analysis with Bioconductor (GBCC2025)\nOrchestrating Microbiome Analysis with Bioconductor (ISMB/ECCB 2025)\n\n\n\nCourses\n\nIntroduction\nOutro"
  },
  {
    "objectID": "index.html#contributions",
    "href": "index.html#contributions",
    "title": "Quarto presentations",
    "section": "Contributions",
    "text": "Contributions\nYou are welcome to add new presentations or improve the current ones. The guidelines for contributors are explained here. The presentations are deployed from the quarto sub-directory, so you need to make the respective changes there and run cd quarto/; quarto render.\nThe following is a quick workflow for contributions:\n\nfork the repository\nadd your qmd file(s) to the quarto sub-directory\nupdate the _quarto.yml file and the list of presentations in the website with the name of the qmd file(s) with your presentation(s)\nrun quarto render, or in R quarto::quarto_render(myfilename) from your terminal from within the quarto sub-directory\nand make a pull request to the master branch\n\nThis documentation provides more details about publishing quarto presentations with GitHub Pages."
  },
  {
    "objectID": "functional_analysis.html#metagenomics",
    "href": "functional_analysis.html#metagenomics",
    "title": "Functional analysis",
    "section": "Metagenomics",
    "text": "Metagenomics\n\nReveals functional potential of a community, beyond taxonomy\nRedundant genes ‚Üí functional stability\nFunctional compensation: missing species can be replaced by others\n\n\nMetagenomics tells us what microbes can do, not just who is there. Useful for understanding resilience and redundancy in microbiomes.\nFunctions/genes can be more interesting sometimes as microbial functions matter, not which bacteria causes the effect (for instance, in disease)\nEven though one microbe goes away, another taxa can take its ‚Äújob‚Äù in the ecosystem.\nTo explore what microbes are actually doing, we need more metabolomics data for instance."
  },
  {
    "objectID": "functional_analysis.html#metagenomic-data",
    "href": "functional_analysis.html#metagenomic-data",
    "title": "Functional analysis",
    "section": "Metagenomic data",
    "text": "Metagenomic data\n\nTaxonomic profiles: species, genera, etc.\nFunctional profiles: genes, pathways, metabolic modules\nLinkage: which taxa contribute to which functions\n\n\nFunctional profiles can be derived using tools like HUMAnN. They often complement or outperform taxonomic profiles for certain analyses.\nThe data includes: - what bacteria are present - what genes are present - which bacteria includes the genes"
  },
  {
    "objectID": "functional_analysis.html#analysis-approaches",
    "href": "functional_analysis.html#analysis-approaches",
    "title": "Functional analysis",
    "section": "Analysis approaches",
    "text": "Analysis approaches\n\nAnalyze functional data using the same methods as taxonomy\nIntegration enables multi-omics perspective\nDo functional shifts mirror taxonomic shifts?\n\n\ne.g.¬†MaAsLin, dbRDA, PERMANOVA, ordination can be used\nExample: Run dbRDA or PERMANOVA on functional data and compare to taxonomy. Highlights cases where functions remain stable despite taxonomic changes, or vice versa."
  },
  {
    "objectID": "functional_analysis.html#references",
    "href": "functional_analysis.html#references",
    "title": "Functional analysis",
    "section": "References",
    "text": "References\n\n\n\n\nhttps://microbiome.github.io/"
  },
  {
    "objectID": "miadash.html#origins",
    "href": "miadash.html#origins",
    "title": "Microbiome Analysis Dashboard",
    "section": "Origins",
    "text": "Origins\nWhile attending workshops at EuroBioc2023, I got to play with iSEE."
  },
  {
    "objectID": "miadash.html#isee",
    "href": "miadash.html#isee",
    "title": "Microbiome Analysis Dashboard",
    "section": "iSEE",
    "text": "iSEE\niSEE is a very nice app that lets you visualise SummarizedExperiment objects in an interactive way (Rue-Albrecht et al. 2018). However it had no support for ü¶†ü¶†ü¶†."
  },
  {
    "objectID": "miadash.html#iseetree",
    "href": "miadash.html#iseetree",
    "title": "Microbiome Analysis Dashboard",
    "section": "iSEEtree",
    "text": "iSEEtree\nSo we thought why not adding support for ü¶†ü¶†ü¶†, and we developed iSEEtree to visualise TreeSummarizedExperiment objects in an interactive way (Benedetti et al. 2024)."
  },
  {
    "objectID": "miadash.html#half-way-there",
    "href": "miadash.html#half-way-there",
    "title": "Microbiome Analysis Dashboard",
    "section": "Half-way there!",
    "text": "Half-way there!\niSEEtree is very nice, but why not having a graphical user interface with full mia functionality, from importing data to plotting results?"
  },
  {
    "objectID": "miadash.html#miadash",
    "href": "miadash.html#miadash",
    "title": "Microbiome Analysis Dashboard",
    "section": "miaDash",
    "text": "miaDash\nAn app that translates the mia functionality to a graphical user interface."
  },
  {
    "objectID": "miadash.html#try-the-app",
    "href": "miadash.html#try-the-app",
    "title": "Microbiome Analysis Dashboard",
    "section": "Try the app",
    "text": "Try the app\nVisit miaDash at this address or by scanning the QR code below."
  },
  {
    "objectID": "miadash.html#references",
    "href": "miadash.html#references",
    "title": "Microbiome Analysis Dashboard",
    "section": "References",
    "text": "References\n\n\n\n\n\n\n\n\nBenedetti, Giulio, Ely Seraidarian, Theotime Pralas, Akewak Jeba, Tuomas Borman, and Leo Lahti. 2024. ‚ÄúiSEEtree: Interactive Explorer for Hierarchical Data.‚Äù https://arxiv.org/abs/2412.02882.\n\n\nRue-Albrecht, Kevin, Federico Marini, Charlotte Soneson, and Aaron TL Lun. 2018. ‚ÄúiSEE: Interactive Summarizedexperiment Explorer.‚Äù F1000Research 7. https://doi.org/10.12688/f1000research.14966.1."
  },
  {
    "objectID": "intro.html#orchestrating-microbiome-analysis-with-bioconductor",
    "href": "intro.html#orchestrating-microbiome-analysis-with-bioconductor",
    "title": "Introduction",
    "section": "Orchestrating Microbiome Analysis with Bioconductor",
    "text": "Orchestrating Microbiome Analysis with Bioconductor"
  },
  {
    "objectID": "intro.html#schedule",
    "href": "intro.html#schedule",
    "title": "Introduction",
    "section": "Schedule",
    "text": "Schedule\nDay 1 ‚Äî Mon: Introduction to Bioconductor framework\nDay 2 ‚Äî Tue: Data wrangling\nDay 3 ‚Äî Wed: Community diversity & composition\nDay 4 ‚Äî Thu: Statistical testing\nDay 5 ‚Äî Fri: Advanced topics\n\nOverview of the week"
  },
  {
    "objectID": "intro.html#practicalities",
    "href": "intro.html#practicalities",
    "title": "Introduction",
    "section": "Practicalities",
    "text": "Practicalities\n\nEach topic: short lecture + demonstration\nMajority of time: hands-on practice\nMaterials follow the ‚ÄúOrchestrating Microbiome Analysis‚Äù OMA online book\nSlack channel: for real-time support\nThe openly licensed teaching material will be available online during and after the course\n\n\nHands-on learning is the focus ‚Äî you‚Äôll learn best by doing. Feel free to interrupt and ask questions anytime. The OMA book is a lasting resource you can return to.\nYou should do hands-on with your local computer. Have you installed packages? ‚Äì&gt; Help is provided when doing first exercises. RStudio is recommended along with Quarto/RMarkdown, but plain R files are ok if you are familiar with them."
  },
  {
    "objectID": "intro.html#questions",
    "href": "intro.html#questions",
    "title": "Introduction",
    "section": "Questions",
    "text": "Questions\n\nWhat are mia and OMA?\nHow microbiome data science is conducted in SummarizedExperiment ecosystem?\nWhat benefits this new ecosystem have compared to previous approaches?\n\n\nThese are the questions that you might have at this point. Hopefully, I am able to answer them during the week.\nmia is the package family and OMA is the online book and ecosystem.\nHow this SummarizedExperiment ecosystem is applied to microbiome data science and what benefits it has compared to other approaches, including custom scripts, phyloseq and other data containers."
  },
  {
    "objectID": "intro.html#objectives",
    "href": "intro.html#objectives",
    "title": "Introduction",
    "section": "Objectives",
    "text": "Objectives\n\nAnalyze microbiome data using the r BiocStyle::Biocpkg(\"SummarizedExperiment\") ecosystem\nCreate & interpret visualizations\nExplore documentation & tools via the OMA book\n\n\nBy the end of the course, you‚Äôll be able to apply SE-based methods, create meaningful plots, and know where to go for further learning."
  },
  {
    "objectID": "intro.html#references",
    "href": "intro.html#references",
    "title": "Introduction",
    "section": "References",
    "text": "References"
  },
  {
    "objectID": "import.html#section-2",
    "href": "import.html#section-2",
    "title": "Import data",
    "section": "",
    "text": "mia is for downstream analysis"
  },
  {
    "objectID": "import.html#importers-and-converters",
    "href": "import.html#importers-and-converters",
    "title": "Import data",
    "section": "Importers and converters",
    "text": "Importers and converters\n\nmia includes importers and converters for standard data formats\n\nImporter: Import file\nConverter: Convert R object to other format\n\nYou can also create TreeSE object manually\n\n\nImporters and converters for standard data formats.\nYou can also create TreeSE object manually by hand if you have csv or excel files."
  },
  {
    "objectID": "import.html#open-databases",
    "href": "import.html#open-databases",
    "title": "Import data",
    "section": "Open databases",
    "text": "Open databases\n\n\n\n\n\n\n\n\n\nData resource\nPackage\n# studies or datasets\n# samples\n\n\n\n\nCurated metagenomic data (Pasolli et al. 2017)\ncuratedMetagenomicData (Pasolli et al. 2017)\n93\n22,588\n\n\nHoloFood (Rogers et al. 2025)\nHoloFoodR (Borman, Sannikov, and Lahti 2025)\n-\n9,990\n\n\nMGnify (Gurbich et al. 2023)\nMGnifyR (Borman, Allen, and Lahti 2025)\n5129\n616,138\n\n\nMicrobiome benchmark data (Gamboa-Tuz et al. 2025)\nMicrobiomeBenchmarkData (Gamboa-Tuz et al. 2025)\n6\n1,125\n\n\nmicrobiomeDataSets (Lahti, Ernst, and Shetty 2025)\nmicrobiomeDataSets (Lahti, Ernst, and Shetty 2025)\n6\n19,100\n\n\n\n\nThere are many freely available databases for microbiome data.\nFor method development, benchmarking, or gaining new insights."
  },
  {
    "objectID": "import.html#demonstration",
    "href": "import.html#demonstration",
    "title": "Import data",
    "section": "Demonstration",
    "text": "Demonstration"
  },
  {
    "objectID": "import.html#section-3",
    "href": "import.html#section-3",
    "title": "Import data",
    "section": "",
    "text": "library(mia)\n\ntse &lt;- importBIOM(\"file_path.biom\")\nprint(tse)\n\n\nclass: TreeSummarizedExperiment \ndim: 19216 26 \nmetadata(0):\nassays(1): counts\nrownames(19216): 549322 522457 ... 200359 271582\nrowData names(7): Kingdom Phylum ... Genus Species\ncolnames(26): CL3 CC1 ... Even2 Even3\ncolData names(7): X.SampleID Primer ... SampleType Description\nreducedDimNames(0):\nmainExpName: NULL\naltExpNames(0):\nrowLinks: a LinkDataFrame (19216 rows)\nrowTree: 1 phylo tree(s) (19216 leaves)\ncolLinks: NULL\ncolTree: NULL"
  },
  {
    "objectID": "import.html#exercises",
    "href": "import.html#exercises",
    "title": "Import data",
    "section": "Exercises",
    "text": "Exercises\nFrom OMA online book, Chapter 4: Import\n\nExercise 1"
  },
  {
    "objectID": "import.html#references",
    "href": "import.html#references",
    "title": "Import data",
    "section": "References",
    "text": "References\n\n\n\n\nhttps://microbiome.github.io/\n\n\n\n\nBorman, Tuomas, Ben Allen, and Leo Lahti. 2025. MGnifyR: R Interface to EBI MGnify Metagenomics Resource. https://github.com/EBI-Metagenomics/MGnifyR.\n\n\nBorman, Tuomas, Artur Sannikov, and Leo Lahti. 2025. HoloFoodR: R Interface to EBI HoloFood Resource. https://github.com/EBI-Metagenomics/HoloFoodR.\n\n\nGamboa-Tuz, Samuel D., Marcel Ramos, Eric Franzosa, Curtis Huttenhower, Nicola Segata, Sehyun Oh, and Levi Waldron. 2025. ‚ÄúCommonly Used Compositional Data Analysis Implementations Are Not Advantageous in Microbial Differential Abundance Analyses Benchmarked Against Biological Ground Truth.‚Äù bioRxiv. https://doi.org/10.1101/2025.02.13.638109.\n\n\nGurbich, Tatiana A., Alexandre Almeida, Martin Beracochea, Tony Burdett, Josephine Burgin, Guy Cochrane, Shriya Raj, et al. 2023. ‚ÄúMGnify Genomes: A Resource for Biome-Specific Microbial Genome Catalogues.‚Äù Journal of Molecular Biology, Computation resources for molecular biology, 435 (14): 168016. https://doi.org/10.1016/j.jmb.2023.168016.\n\n\nLahti, Leo, Felix G. M. Ernst, and Sudarshan Shetty. 2025. microbiomeDataSets: Experiment Hub Based Microbiome Datasets. https://doi.org/10.18129/B9.bioc.microbiomeDataSets.\n\n\nPasolli, Edoardo, Lucas Schiffer, Paolo Manghi, Audrey Renson, Valerie Obenchain, Duy Tin Truong, Francesco Beghini, et al. 2017. ‚ÄúAccessible, Curated Metagenomic Data Through ExperimentHub.‚Äù Nature Methods 14 (11): 1023‚Äì24. https://doi.org/10.1038/nmeth.4468.\n\n\nRogers, Alexander B, Varsha Kale, Germana Baldi, Antton Alberdi, M Thomas P Gilbert, Dipayan Gupta, Morten T Limborg, et al. 2025. ‚ÄúHoloFood Data Portal: Holo-Omic Datasets for Analysing Host‚ÄìMicrobiota Interactions in Animal Production.‚Äù Database (Oxford) 2025: baae112. https://doi.org/10.1093/database/baae112."
  },
  {
    "objectID": "bioc2023.html#orchestrating-microbiome-multi-omics-with-r-and-bioconductor",
    "href": "bioc2023.html#orchestrating-microbiome-multi-omics-with-r-and-bioconductor",
    "title": "Orchestrating microbiome multi-omics",
    "section": "Orchestrating microbiome multi-omics with R and Bioconductor",
    "text": "Orchestrating microbiome multi-omics with R and Bioconductor\n\nLeo Lahti @antagomir | Department of Computing, University of Turku, Finland"
  },
  {
    "objectID": "bioc2023.html#organizing-microbiome-data",
    "href": "bioc2023.html#organizing-microbiome-data",
    "title": "Orchestrating microbiome multi-omics",
    "section": "Organizing microbiome data",
    "text": "Organizing microbiome data\n\n\n\nSide information\nsample & feature metadata\nMultiple assays\ncounts, relabundance, phILR..\nAlternative experiments¬†\n16S, metagenome, phylogenetic microarrays; pipelines\nCross-kingdom analyses¬† bacteriome, archaeome, virome, mykobiome, eukaryome\nHierarchical data\ntaxonomic levels, nested designs, sample & feature trees"
  },
  {
    "objectID": "bioc2023.html#section",
    "href": "bioc2023.html#section",
    "title": "Orchestrating microbiome multi-omics",
    "section": "",
    "text": "Fig. by Domenick Braccia (EuroBioC 2020)"
  },
  {
    "objectID": "bioc2023.html#integrating-multiple-experiments",
    "href": "bioc2023.html#integrating-multiple-experiments",
    "title": "Orchestrating microbiome multi-omics",
    "section": "Integrating multiple experiments",
    "text": "Integrating multiple experiments\nCombine taxonomic, metagenomic & functional profiling, and host measurements¬†\nby extending the Bioconductor MultiAssayExperiment class."
  },
  {
    "objectID": "bioc2023.html#benefits-for-microbiome-data-science",
    "href": "bioc2023.html#benefits-for-microbiome-data-science",
    "title": "Orchestrating microbiome multi-omics",
    "section": "Benefits for microbiome data science",
    "text": "Benefits for microbiome data science\n\n\n\n\nExtended\nenhances multi-assay analyses in microbiome studies\nOptimized\nspeed, memory & scale (sample sizes, datasets, cohorts)\nIntegrated\nwith other applications & frameworks (e.g.¬†Single Cell, Spatial transcriptomics)"
  },
  {
    "objectID": "bioc2023.html#package-and-data-ecosystem",
    "href": "bioc2023.html#package-and-data-ecosystem",
    "title": "Orchestrating microbiome multi-omics",
    "section": "Package and data ecosystem",
    "text": "Package and data ecosystem\nBioconductor methods & packages supporting the framework.\n\n\n\n\n\nBasic wrangling: transformations, agglomeration, split/merge etc.\nAlpha & beta diversity\nDimension reduction (scater)\nDifferential abundance (ANCOMBC, ALDEx2, benchdamic)\nVisualization (miaViz)\nTime series manipulation (miaTime)\nEcological simulations (miaSim)"
  },
  {
    "objectID": "bioc2023.html#section-1",
    "href": "bioc2023.html#section-1",
    "title": "Orchestrating microbiome multi-omics",
    "section": "",
    "text": "Importers for other common formats\nLinking with other common formats and microbiome data science frameworks.\n   \nOpen data resources\nOpen microbiome data sets readily available in TreeSummarizedExperiment format via curatedMetagenomicData, EBI MGnify, Bioconductor ExperimentHub, and packages."
  },
  {
    "objectID": "bioc2023.html#minimal-example",
    "href": "bioc2023.html#minimal-example",
    "title": "Orchestrating microbiome multi-omics",
    "section": "Minimal example",
    "text": "Minimal example\nCross-correlating taxonomic and metabolomic profiles from a dietary intervention study in mice (Hintikka et al.¬†2021).\n\nlibrary(mia)\n\n# Import data and rename\ndata(\"HintikkaXOData\")\nmae &lt;- HintikkaXOData\n  \n# Agglomerate rare taxa by prevalence at the Family level & log10-transform read  counts\nmae[[\"microbiota\"]] &lt;- agglomerateByPrevalence(mae[[\"microbiota\"]], rank = \"Family\")\nmae[[\"microbiota\"]] &lt;- transformAssay(mae[[\"microbiota\"]], method = \"clr\", pseudocount = 1)\n\n# Get cross-correlation between taxa & metabolites\nx &lt;- testExperimentCrossAssociation(mae, experiment1 = \"microbiota\", experiment2 = \"metabolites\",\n                                               assay.type1 = \"clr\", assay.type2 = \"nmr\",\n                                               mode = \"matrix\", sort = TRUE)$cor\n\n# Visualize taxa-metabolite associations on heatmap\nComplexHeatmap::Heatmap(x)"
  },
  {
    "objectID": "bioc2023.html#documentation-oma-gitbook-beta",
    "href": "bioc2023.html#documentation-oma-gitbook-beta",
    "title": "Orchestrating microbiome multi-omics",
    "section": "Documentation: OMA Gitbook (beta)",
    "text": "Documentation: OMA Gitbook (beta)\nComplements other Bioconductor Gitbooks; overlapping methods and analysis strategies: microbiome.github.io/OMA"
  },
  {
    "objectID": "bioc2023.html#community",
    "href": "bioc2023.html#community",
    "title": "Orchestrating microbiome multi-omics",
    "section": "Community",
    "text": "Community\n\n\nCoordination: Tuomas Borman, Leo Lahti\nGiulio Benedetti, Yaƒümur ≈ûim≈üek, Basil Courbayre, Jeba Akewak, Daena Rys, Henrik Eckermann, Chouaib Benchraka, Rajesh Shigdel, Artur Sannikov, Lu Yang, Renuka Potbhare, S. A. Shetty, R. Huang, F. G.M. Ernst, D. J. Braccia, H. C. Bravo; 20+ contributors, 10+ countries. Welcome to join!\nAcknowledgments: TreeSummarizedExperiment, SingleCellExperiment, MultiAssayExperiment, curatedMetagenomicData, MGnifyR, phILR, ANCOMBC, ALDEx2, benchdamic, scater, scuttle authors..\nCourses in 2023: Pune (IND) | Turku & Oulu (FIN) | Utrecht, Wageningen & Radboud (NLD) | Norwich (UK) |Bergen (NO)"
  },
  {
    "objectID": "bioc2023.html#bioconductor-books",
    "href": "bioc2023.html#bioconductor-books",
    "title": "Orchestrating microbiome multi-omics",
    "section": "Bioconductor books",
    "text": "Bioconductor books"
  },
  {
    "objectID": "bioc2023.html#resources",
    "href": "bioc2023.html#resources",
    "title": "Orchestrating microbiome multi-omics",
    "section": "Resources",
    "text": "Resources\nMicrobiome R package listing:\ngithub.com/microsud/Tools-Microbiome-Analysis"
  },
  {
    "objectID": "bioc2023.html#microbiome-data-science-workflow",
    "href": "bioc2023.html#microbiome-data-science-workflow",
    "title": "Orchestrating microbiome multi-omics",
    "section": "Microbiome data science workflow",
    "text": "Microbiome data science workflow\n\n\nData containers:\n\nTreeSummarizedExperiment\nMultiAssayExperiment\n\nR/Bioc packages:\nmia, miaViz\n\n\n\n\nFigure by Domenick Braccia (EuroBioC 2020)"
  },
  {
    "objectID": "bioc2023.html#misc",
    "href": "bioc2023.html#misc",
    "title": "Orchestrating microbiome multi-omics",
    "section": "Misc",
    "text": "Misc\n\nFigure source: Moreno-Indias et al.¬†(2021) Statistical and Machine Learning Techniques in Human Microbiome Studies: Contemporary Challenges and Solutions. Frontiers in Microbiology 12:11."
  },
  {
    "objectID": "bioc2023.html#treesummarizedexperiment",
    "href": "bioc2023.html#treesummarizedexperiment",
    "title": "Orchestrating microbiome multi-omics",
    "section": "TreeSummarizedExperiment",
    "text": "TreeSummarizedExperiment"
  },
  {
    "objectID": "bioc2023.html#optimal-container-for-microbiome-data-integration",
    "href": "bioc2023.html#optimal-container-for-microbiome-data-integration",
    "title": "Orchestrating microbiome multi-omics",
    "section": "Optimal container for microbiome data integration?",
    "text": "Optimal container for microbiome data integration?\nImprove interoperability, ensure sustainability.\n\n\nMultiple assays\nseamless interlinking\nSide information\nextended capabilities & data types\nHierarchical data\nboth samples & features\nOptimized\nspeed & memory\nIntegrated\nother applications & frameworks"
  },
  {
    "objectID": "bioc2023.html#data-integration-in-microbiomics",
    "href": "bioc2023.html#data-integration-in-microbiomics",
    "title": "Orchestrating microbiome multi-omics",
    "section": "Data integration in microbiomics",
    "text": "Data integration in microbiomics\n\nScaling up sample size (cohorts & meta-analyses)\nComplementary pipelines\nAlternative experiments (e.g.¬†16S, metagenome, phylogenetic microarrays)\nMultiple assays (e.g.¬†counts, relative abundances, clr, phILR)\nHierarchies in feature & sample space (phylogenies, nested designs)\nCross-kingdom analyses (bacteriome, virome, mykobiome, eukaryome)\nMulti-omics (taxonomy, function, host)"
  },
  {
    "objectID": "bioc2023.html#optimal-container-for-microbiome-data-integration-1",
    "href": "bioc2023.html#optimal-container-for-microbiome-data-integration-1",
    "title": "Orchestrating microbiome multi-omics",
    "section": "Optimal container for microbiome data integration?",
    "text": "Optimal container for microbiome data integration?\nImprove interoperability, ensure sustainability.\n\n\nMultiple assays\nseamless interlinking\nSide information\nextended capabilities & data types\nHierarchical data\nboth samples & features\nOptimized\nspeed & memory\nIntegrated\nother applications & frameworks"
  },
  {
    "objectID": "bioc2023.html#linking-multiple-omics",
    "href": "bioc2023.html#linking-multiple-omics",
    "title": "Orchestrating microbiome multi-omics",
    "section": "Linking multiple omics",
    "text": "Linking multiple omics\nTaxonomic, metagenomic & functional profiling, host measurements"
  },
  {
    "objectID": "bioc2023.html#open-data-resources-1",
    "href": "bioc2023.html#open-data-resources-1",
    "title": "Orchestrating microbiome multi-omics",
    "section": "Open data resources",
    "text": "Open data resources\n\ncuratedMetagenomicData (Pasolli et al.¬†2017)\nEBI MGnify (Mitchell et al.¬†2020)\nmicrobiomeDataSets (Ernst et al.¬†2020);\nR package demo data sets\nImport functions for common formats (Biom, QIIME2, Mothur, phyloseq)"
  },
  {
    "objectID": "agglomeration.html#agglomeration",
    "href": "agglomeration.html#agglomeration",
    "title": "Agglomeration",
    "section": "Agglomeration",
    "text": "Agglomeration\nCombining features into higher-level taxa\nExample data (Gupta et al., mSystems 2019)\n\nDownload zip file from Slack (day1)\nImport the data (script also online\n\n\nlibrary(mia)\nlibrary(ape)\n\ndir &lt;- \"GuptaA_2019\"\n\n# Read taxonomy data into TreeSE\nrd &lt;- read.csv(file.path(dir, \"taxonomy_table.csv\"), row.names = 1L) |&gt; DataFrame()\ncd &lt;- read.csv(file.path(dir, \"sample_metadata.csv\"), row.names = 1L) |&gt; DataFrame()\nassay &lt;- read.csv(file.path(dir, \"taxonomy_abundance.csv\"), row.names = 1L) |&gt; as.matrix()\ntree &lt;- read.tree(file.path(dir, \"phylogeny.tree\"))\ntse &lt;- TreeSummarizedExperiment(\n    assays = SimpleList(counts = assay),\n    rowData = rd,\n    colData = cd,\n    rowTree = tree\n)\n\nsaveRDS(tse, \"Gupta2019.rds\")\ntse &lt;- readRDS(\"Gupta2019.rds\")"
  },
  {
    "objectID": "agglomeration.html#why",
    "href": "agglomeration.html#why",
    "title": "Agglomeration",
    "section": "Why?",
    "text": "Why?\n\nFocus on biologically meaningful units\nReduce sparsity and noise\nImprove interpretability of downstream analyses\n\n\n\nFocusing on higher-level taxa (e.g., genera instead of thousands of ASVs) helps highlight biologically relevant patterns.\n16S sequencing often does not resolve taxa below genus level reliably.\nAgglomeration reduces noise from sequencing artifacts and rare features.\nMakes downstream analyses like diversity metrics, ordination, and association studies more interpretable.\nNote: Some resolution is lost when collapsing features‚Äîbalance simplicity with detail."
  },
  {
    "objectID": "agglomeration.html#section",
    "href": "agglomeration.html#section",
    "title": "Agglomeration",
    "section": "",
    "text": "Species belonging to Genus A are summed up together‚Ä¶"
  },
  {
    "objectID": "agglomeration.html#demonstration",
    "href": "agglomeration.html#demonstration",
    "title": "Agglomeration",
    "section": "Demonstration",
    "text": "Demonstration\nlibrary(mia)\n\ntse &lt;- agglomerateByRank(tse, rank = \"Phylum\")\nprint(tse)\n\n\nclass: TreeSummarizedExperiment \ndim: 66 26 \nmetadata(1): agglomerated_by_rank\nassays(1): counts\nrownames(66): ABY1_OD1 AC1 ... ZB2 ZB3\nrowData names(7): Kingdom Phylum ... Genus Species\ncolnames(26): CL3 CC1 ... Even2 Even3\ncolData names(7): X.SampleID Primer ... SampleType Description\nreducedDimNames(0):\nmainExpName: NULL\naltExpNames(0):\nrowLinks: a LinkDataFrame (66 rows)\nrowTree: 1 phylo tree(s) (66 leaves)\ncolLinks: NULL\ncolTree: NULL"
  },
  {
    "objectID": "agglomeration.html#section-1",
    "href": "agglomeration.html#section-1",
    "title": "Agglomeration",
    "section": "",
    "text": "tse &lt;- agglomerateByRanks(tse)\nprint(tse)\n\n\nclass: TreeSummarizedExperiment \ndim: 19216 26 \nmetadata(0):\nassays(1): counts\nrownames(19216): 549322 522457 ... 200359 271582\nrowData names(7): Kingdom Phylum ... Genus Species\ncolnames(26): CL3 CC1 ... Even2 Even3\ncolData names(7): X.SampleID Primer ... SampleType Description\nreducedDimNames(0):\nmainExpName: NULL\naltExpNames(7): Kingdom Phylum ... Genus Species\nrowLinks: a LinkDataFrame (19216 rows)\nrowTree: 1 phylo tree(s) (19216 leaves)\ncolLinks: NULL\ncolTree: NULL"
  },
  {
    "objectID": "agglomeration.html#exercises",
    "href": "agglomeration.html#exercises",
    "title": "Agglomeration",
    "section": "Exercises",
    "text": "Exercises\nFrom OMA online book, Chapter 10: Agglomeration\n\n1.2, 1.3, 1.4, 1.5, 1.6"
  },
  {
    "objectID": "agglomeration.html#references",
    "href": "agglomeration.html#references",
    "title": "Agglomeration",
    "section": "References",
    "text": "References"
  },
  {
    "objectID": "mgnifyr.html#contents",
    "href": "mgnifyr.html#contents",
    "title": "MGnifyR: An R package for accessing MGnify microbiome data",
    "section": "Contents",
    "text": "Contents\n\nBioconductor\nMGnifyR R package\nmia (Microbiome Analysis) within Bioconductor\n\n\n11:30 ‚Äî 12:30\nThe idea of the first half of our sessions is to introduce Bioconductor, data containers, and MGnifyR R packages that bridges the gap between MGnify database and statistical tools in Bioconductor.\nThen we have a lunch break.\n13:30 ‚Äî 15:15\nIn second half, we will go deeper on the statistical analysis."
  },
  {
    "objectID": "mgnifyr.html#bioconductor",
    "href": "mgnifyr.html#bioconductor",
    "title": "MGnifyR: An R package for accessing MGnify microbiome data",
    "section": "Bioconductor",
    "text": "Bioconductor\n\nCommunity-driven open-source project\nHigh-quality, tested statistical methods\nWell-documented\n\n\n\n\nBioconductor is more than software.\nWorldwide community of bioinformaticians; both users and developers."
  },
  {
    "objectID": "mgnifyr.html#summarizedexperiment",
    "href": "mgnifyr.html#summarizedexperiment",
    "title": "MGnifyR: An R package for accessing MGnify microbiome data",
    "section": "SummarizedExperiment",
    "text": "SummarizedExperiment\n(Huber et al. 2015)\n\n\nThe software in Bioconductor is based on data containers. Structured way to store and manage complex (biological) data.\nWhen you put data in this format, you can easily apply methods and run statistical analysis and visualize results."
  },
  {
    "objectID": "mgnifyr.html#mgnify",
    "href": "mgnifyr.html#mgnify",
    "title": "MGnifyR: An R package for accessing MGnify microbiome data",
    "section": "MGnify",
    "text": "MGnify\n\nMicrobiome database hosted by EMBL/EBI\nStandardized bioinformatics pipelines\nTaxonomy and functional mappings\n\n \n\nOf course, you can import your own data to these data containers and that is what is done in many studies.\nHowever, we have this amazing database MGnify already containing harmonized and huge database.\n\nRaw sequences from ENA\nOpen access\nTaxonomy and functional mappings along with genome catalogues\nApplication Programming Interface (API)"
  },
  {
    "objectID": "mgnifyr.html#mgnifyr",
    "href": "mgnifyr.html#mgnifyr",
    "title": "MGnifyR: An R package for accessing MGnify microbiome data",
    "section": "MGnifyR",
    "text": "MGnifyR\n\nFetch data from MGnify directly to SummarizedExperiment format\nBridges the gap between data resources and tools\n\n\n\nChallenges in API\n\nRequires familiarity with API workflows, database structures, and linkages.\nLeads to challenges in reproducibility and time-consuming data wrangling.\n\nWith MGnifyR, you can fetch the data from MGnify database directly into SummarizedExperiment format. When you have the data in this format, you can immdediately apply methods from Bioconductor without any data wrangling.\nHalf million samples currently from environment, human and other systems with sample metadata such as diagnosis and so forth"
  },
  {
    "objectID": "mgnifyr.html#demonstration",
    "href": "mgnifyr.html#demonstration",
    "title": "MGnifyR: An R package for accessing MGnify microbiome data",
    "section": "Demonstration",
    "text": "Demonstration"
  },
  {
    "objectID": "mgnifyr.html#section",
    "href": "mgnifyr.html#section",
    "title": "MGnifyR: An R package for accessing MGnify microbiome data",
    "section": "",
    "text": "library(\"MGnifyR\")\n\nWe load the package. The package is in Bioconductor."
  },
  {
    "objectID": "mgnifyr.html#section-1",
    "href": "mgnifyr.html#section-1",
    "title": "MGnifyR: An R package for accessing MGnify microbiome data",
    "section": "",
    "text": "mg &lt;- MgnifyClient(\n    useCache = TRUE,\n    cacheDir = file.path(\"home\", \"training\", \"course_dir\", \"data_dir\")\n)\n\nFirst step is always to create MgnifyClient object. It holds settings for retrieval of data, including caching information.\nWe use cache here because the fetching can take couple hours. I have preloaded the data to that specific cache directory."
  },
  {
    "objectID": "mgnifyr.html#section-2",
    "href": "mgnifyr.html#section-2",
    "title": "MGnifyR: An R package for accessing MGnify microbiome data",
    "section": "",
    "text": "analysis_id &lt;- searchAnalysis(\n    mg,\n    type = \"studies\",\n    accession = \"MGYS00005154\"\n)\n\nNext we can first instance browse the MGnify website. I have selected the following study MGYS00005154. In this study, they collected fecal samples across age and geography.\nWe search all analyses that are related to this study. Analyses are bioinformatics pipeline (taxonomy mapping) results.\nWe get IDs for each analysis."
  },
  {
    "objectID": "mgnifyr.html#section-3",
    "href": "mgnifyr.html#section-3",
    "title": "MGnifyR: An R package for accessing MGnify microbiome data",
    "section": "",
    "text": "metadata &lt;- getMetadata(mg, accession = analysis_id)\n\nThen we fetch metadata on these analyses. They include, for instance, the sample information and information on analysis pipeline."
  },
  {
    "objectID": "mgnifyr.html#section-4",
    "href": "mgnifyr.html#section-4",
    "title": "MGnifyR: An R package for accessing MGnify microbiome data",
    "section": "",
    "text": "# Get logical vector specifying whether the utilized pipeline was\n# the latest one\nlatest_pipeline &lt;- metadata[[\"analysis_pipeline-version\"]] == \"5.0\"\n\n# Subset the metadata by selecting only analyses from the\n# latest pipeline\nmetadata &lt;- metadata[latest_pipeline, ]\n\n# Get the IDs\nselected_ids &lt;- metadata[[\"analysis_accession\"]]\n\nThe result is a table. For instance, we can see that multiple analyses were conducted to single samples.\nWe select analyses that were done with the latest pipeline. This ensures that the samples are comparable."
  },
  {
    "objectID": "mgnifyr.html#section-5",
    "href": "mgnifyr.html#section-5",
    "title": "MGnifyR: An R package for accessing MGnify microbiome data",
    "section": "",
    "text": "tse &lt;- getResult(\n    mg,\n    accession = selected_ids,\n    get.func = FALSE\n)\ntse\n\n\nclass: TreeSummarizedExperiment \ndim: 19216 26 \nmetadata(0):\nassays(1): counts\nrownames(19216): 549322 522457 ... 200359 271582\nrowData names(7): Kingdom Phylum ... Genus Species\ncolnames(26): CL3 CC1 ... Even2 Even3\ncolData names(7): X.SampleID Primer ... SampleType Description\nreducedDimNames(0):\nmainExpName: NULL\naltExpNames(0):\nrowLinks: a LinkDataFrame (19216 rows)\nrowTree: 1 phylo tree(s) (19216 leaves)\ncolLinks: NULL\ncolTree: NULL\n\n\n\nNow we can fetch the taxonomy annotations to SummarizedExperiment object. To do that, we input the analysis IDs that we want to fetch. We also specify that we do not want functional annotations (although they are available)."
  },
  {
    "objectID": "mgnifyr.html#references",
    "href": "mgnifyr.html#references",
    "title": "MGnifyR: An R package for accessing MGnify microbiome data",
    "section": "References",
    "text": "References\n\n\n\n\nhttps://microbiome.github.io/\n\n\n\n\nHuber, W., V. J. Carey, R. Gentleman, S. Anders, M. Carlson, B. S. Carvalho, H. C. Bravo, et al. 2015. ‚ÄúOrchestrating High-Throughput Genomic Analysis with Bioconductor.‚Äù Nature Methods 12 (2): 115‚Äì21. http://www.nature.com/nmeth/journal/v12/n2/full/nmeth.3252.html."
  },
  {
    "objectID": "ordination.html#ordination",
    "href": "ordination.html#ordination",
    "title": "Ordination",
    "section": "Ordination",
    "text": "Ordination\n\nReduces high-dimensional data to a few informative axes\nProjects samples into lower-dimensional space while preserving distances or variance\nHelps identify patterns, clusters, and gradients across samples\n\n\nOrdination visualizes high-dimensional relationships in 2D or 3D space. Clusters indicate similarity in community composition."
  },
  {
    "objectID": "ordination.html#section",
    "href": "ordination.html#section",
    "title": "Ordination",
    "section": "",
    "text": "This is now 3 dimensional plot. The idea is to rotate the data so that it maximizes the information in 2D."
  },
  {
    "objectID": "ordination.html#section-1",
    "href": "ordination.html#section-1",
    "title": "Ordination",
    "section": "",
    "text": "Illustration. Hand is 3d, shadow is 2d. The goal is to rotate hand so that it resembles hand in 2d ‚Äì&gt; information preserved even though dimensionality is lower."
  },
  {
    "objectID": "ordination.html#ordination-methods",
    "href": "ordination.html#ordination-methods",
    "title": "Ordination",
    "section": "Ordination methods",
    "text": "Ordination methods\n\nPCA, PCoA/MDS, RDA, ‚Ä¶\nEuclidean vs non-Euclidean\nUnsupervised vs supervised\n\n\n\nDifferent techniques depending on goal. PCA is the most basic one and commonly used. However, microbiome data has unique nature that must be taken into account when applying."
  },
  {
    "objectID": "ordination.html#principal-component-analysis-pca",
    "href": "ordination.html#principal-component-analysis-pca",
    "title": "Ordination",
    "section": "Principal component analysis (PCA)",
    "text": "Principal component analysis (PCA)\n\nUnsupervised ordination method\nEuclidean distance\nAitchison distance: CLR + Euclidean distance\n\n\n\nCLR must be applied. Preserves variance."
  },
  {
    "objectID": "ordination.html#principal-coordinate-analysis-pcoa",
    "href": "ordination.html#principal-coordinate-analysis-pcoa",
    "title": "Ordination",
    "section": "Principal coordinate analysis (PCoA)",
    "text": "Principal coordinate analysis (PCoA)\n\nMultidimensional scaling (MDS)\nUnsupervised ordination method\nAny dissimilarity metric (e.g., Bray-Curtis dissimilarity)\n\n\n\nExtension to PCA. Preserves distances. If Euclidean distance is chosen, same as PCA."
  },
  {
    "objectID": "ordination.html#redundancy-analysis-rda",
    "href": "ordination.html#redundancy-analysis-rda",
    "title": "Ordination",
    "section": "Redundancy analysis (RDA)",
    "text": "Redundancy analysis (RDA)\n\nSupervised ordination method\nFind variance explained by sample metadata\n\n\n\nTakes into account covariates. Aims to find variance explained by covariates.\nDistance-based extension (PCoA with covariates)\nIf no covariates are specified, equals to PCA."
  },
  {
    "objectID": "ordination.html#matrix-decomposition",
    "href": "ordination.html#matrix-decomposition",
    "title": "Ordination",
    "section": "Matrix Decomposition",
    "text": "Matrix Decomposition\n\nConceptual basis of ordination: decompose sample √ó taxa matrix\n\n\\[\nX = U \\Sigma V^T\n\\]\n\nUŒ£: sample coordinates in reduced space\nŒ£: importance of each axis\nV: taxa contributions\n\n\n\nMatrix decomposition is the conceptual basis of ordination. Only in Euclidean distances the loadings are easily interpretable."
  },
  {
    "objectID": "ordination.html#demonstration",
    "href": "ordination.html#demonstration",
    "title": "Ordination",
    "section": "Demonstration",
    "text": "Demonstration"
  },
  {
    "objectID": "ordination.html#section-2",
    "href": "ordination.html#section-2",
    "title": "Ordination",
    "section": "",
    "text": "library(mia)\nlibrary(scater)\n\n# Apply transformation\ntse &lt;- transformAssay(tse, method = \"rclr\")"
  },
  {
    "objectID": "ordination.html#section-3",
    "href": "ordination.html#section-3",
    "title": "Ordination",
    "section": "",
    "text": "library(mia)\nlibrary(scater)\n\n# Apply transformation\ntse &lt;- transformAssay(tse, method = \"rclr\")\n# Apply PCA\ntse &lt;- runPCA(tse, assay.type = \"rclr\")"
  },
  {
    "objectID": "ordination.html#section-4",
    "href": "ordination.html#section-4",
    "title": "Ordination",
    "section": "",
    "text": "library(mia)\nlibrary(scater)\n\n# Apply transformation\ntse &lt;- transformAssay(tse, method = \"rclr\")\n# Apply PCA\ntse &lt;- runPCA(tse, assay.type = \"clr\")\n# Visualize\nplotReducedDim(tse, \"PCA\", colour_by = \"patient_status\")"
  },
  {
    "objectID": "ordination.html#exercises",
    "href": "ordination.html#exercises",
    "title": "Ordination",
    "section": "Exercises",
    "text": "Exercises\nFrom OMA online book, Chapter 15: Community similarity\n\nExercise 1\nExercise 2\nExercise 3"
  },
  {
    "objectID": "ordination.html#references",
    "href": "ordination.html#references",
    "title": "Ordination",
    "section": "References",
    "text": "References\n\n\n\n\nhttps://microbiome.github.io/"
  },
  {
    "objectID": "bioconductor.html#bioconductor",
    "href": "bioconductor.html#bioconductor",
    "title": "Bioconductor",
    "section": "Bioconductor",
    "text": "Bioconductor\n\nCommunity-driven, global open-source project\nStarted in 2001 from genomics\nHigh impact across bioinformatics\n\n\n\nProject for developing software in bioinformatics.\nOver 1.5 million distinct IPs per year are downloading."
  },
  {
    "objectID": "bioconductor.html#software",
    "href": "bioconductor.html#software",
    "title": "Bioconductor",
    "section": "Software",
    "text": "Software\n\n~2,300 R packages\nReview, testing, documentation\n\n\n\n\nPopularity has grown.\nBroad range of fields (microbiome is rather small, but steadily raising ~ 50 packages)\nOver 2,300 R packages\nNot limited to R, but R has been the main language. Activity in Python and Julia.\nSpecial abut Bioconductor is the rather strict requirements which ensure the high-quality.\n\nReview process when submitting (novel, relevant, works as it should be, documentation is sufficient) Testing is done automatically (daily). Software must be accessible. ‚Äì&gt; documentation must be good"
  },
  {
    "objectID": "bioconductor.html#microbiome-analysis-mia",
    "href": "bioconductor.html#microbiome-analysis-mia",
    "title": "Bioconductor",
    "section": "Microbiome Analysis (mia)",
    "text": "Microbiome Analysis (mia)\n\nMicrobiome data science ecosystem\n‚ÄúDownstream‚Äù, statistical analysis\n&gt; 15,000 yearly downloads from distinct IPs (top 7.99% in Bioconductor)\n\n\n \n\n\n\nWithin Bioconductor, we have developed microbiome data science ecosystem\nFor downstream analysis\nAligned and tightly linked with broader Bioconductor ecosystem"
  },
  {
    "objectID": "bioconductor.html#related-ecosystems",
    "href": "bioconductor.html#related-ecosystems",
    "title": "Bioconductor",
    "section": "Related ecosystems",
    "text": "Related ecosystems\n\n\nOver the years, several approaches to data organization have been developed. One of the first widely adopted data containers in microbiome research was phyloseq (McMurdie and Holmes 2013), designed for 16S amplicon sequencing data. However, it has limitations, particularly in linking multiple experiments and ensuring interoperability between tools in Bioconductor.\nSummarizedExperiment (SE) (Huber et al. 2015), on the other hand, was introduced as a general-purpose container for biological data and has become the most widely used format within the Bioconductor ecosystem. It has since been extended to more specialized formats, including SingleCellExperiment (Amezquita et al. 2020) for single-cell data and TreeSummarizedExperiment (TreeSE) (Huang et al. 2021), which is tailored for microbiome datasets."
  },
  {
    "objectID": "bioconductor.html#benefits",
    "href": "bioconductor.html#benefits",
    "title": "Bioconductor",
    "section": "Benefits",
    "text": "Benefits\nScience is a community effort:\n\nQuality\nImpact"
  },
  {
    "objectID": "bioconductor.html#community-driven-ecosystem-of-tools",
    "href": "bioconductor.html#community-driven-ecosystem-of-tools",
    "title": "Bioconductor",
    "section": "Community-driven ecosystem of tools",
    "text": "Community-driven ecosystem of tools\n\n\n\nmia (Data analysis)\nmiaViz (Visualization)\nmiaSim (Simulation)\nmiaTime (Time series analysis)\nmiaDash (Graphical user interface)\niSEETree (Interactive visualization)\nExpanded by independent developers\n\n\n             \n\n\nEcosystem of packages developed by the community. mia provides the basic operations in microbiome data analysis. miaViz has the methods for visualization.\nDeveloped by independent developers who have started to support the ecosystem."
  },
  {
    "objectID": "bioconductor.html#data-containers",
    "href": "bioconductor.html#data-containers",
    "title": "Bioconductor",
    "section": "Data containers",
    "text": "Data containers\n\nData containers"
  },
  {
    "objectID": "bioconductor.html#references",
    "href": "bioconductor.html#references",
    "title": "Bioconductor",
    "section": "References",
    "text": "References\n\n\n\n\nAmezquita, Robert A, Aaron T L Lun, Etienne Becht, Vince J Carey, Lindsay N Carpp, Ludwig Geistlinger, Federico Marini, et al. 2020. ‚ÄúOrchestrating Single-Cell Analysis with Bioconductor.‚Äù Nature Methods 17 (2): 137‚Äì45. https://doi.org/10.1038/s41592-019-0654-x.\n\n\nHuang, Ruizhu, Charlotte Soneson, Felix G. M. Ernst, et al. 2021. ‚ÄúTreeSummarizedExperiment: A S4 Class for Data with Hierarchical Structure.‚Äù F1000Research 9: 1246. https://doi.org/10.12688/f1000research.26669.2.\n\n\nHuber, W., V. J. Carey, R. Gentleman, S. Anders, M. Carlson, B. S. Carvalho, H. C. Bravo, et al. 2015. ‚ÄúOrchestrating High-Throughput Genomic Analysis with Bioconductor.‚Äù Nature Methods 12 (2): 115‚Äì21. http://www.nature.com/nmeth/journal/v12/n2/full/nmeth.3252.html.\n\n\nMcMurdie, PJ, and S Holmes. 2013. ‚ÄúPhyloseq: An r Package for Reproducible Interactive Analysis and Graphics of Microbiome Census Data.‚Äù PLoS ONE 8: e61217. https://doi.org/10.1371/journal.pone.0061217."
  },
  {
    "objectID": "bioconductor.html#section",
    "href": "bioconductor.html#section",
    "title": "Bioconductor",
    "section": "",
    "text": "Preprint available"
  },
  {
    "objectID": "bioconductor.html#section-1",
    "href": "bioconductor.html#section-1",
    "title": "Bioconductor",
    "section": "",
    "text": "Preprint available"
  },
  {
    "objectID": "bioconductor.html#orchestrating-microbiome-analysis-with-bioconductor",
    "href": "bioconductor.html#orchestrating-microbiome-analysis-with-bioconductor",
    "title": "Bioconductor",
    "section": "Orchestrating Microbiome Analysis with Bioconductor",
    "text": "Orchestrating Microbiome Analysis with Bioconductor\n\nResources and tutorials for microbiome analysis\nCommunity-built best practices\nOpen to contributions!\n\n\n\n\n\n\n\nGo to the Orchestrating Microbiome Analysis (OMA) online book\n\n\nmicrobiome.github.io/OMA\n\n\n\n\nTo support users and to collect best practices, there is online book available."
  },
  {
    "objectID": "outro.html#thank-you",
    "href": "outro.html#thank-you",
    "title": "Outro",
    "section": "Thank you!",
    "text": "Thank you!\n\n\n\n\n\n\n\n\n\n\nhttps://www.biorxiv.org/content/10.1101/2025.10.29.685036v1\n\n\n\n\n\n\n\n\n\nhttps://microbiome.github.io/OMA"
  },
  {
    "objectID": "outro.html#preprint",
    "href": "outro.html#preprint",
    "title": "Outro",
    "section": "Preprint",
    "text": "Preprint\n\nhttps://www.biorxiv.org/content/10.1101/2025.10.29.685036v1"
  },
  {
    "objectID": "outro.html#online-book",
    "href": "outro.html#online-book",
    "title": "Outro",
    "section": "Online book",
    "text": "Online book\n\nhttps://microbiome.github.io/OMA"
  },
  {
    "objectID": "intro.html#orchestrating-microbiome-analysis-with-bioconductor-1",
    "href": "intro.html#orchestrating-microbiome-analysis-with-bioconductor-1",
    "title": "Introduction",
    "section": "Orchestrating Microbiome Analysis with Bioconductor",
    "text": "Orchestrating Microbiome Analysis with Bioconductor\n\nIntroduces microbiome analysis framework\nFor participants with sufficient programming skills\n\n\n\nThis course introduces mia (microbiome analysis) framework within Bioconductor.\nCentral to Bioconductor is data containers. TreeSummarizedExperiment data container and methods.\nGet to know the participants."
  },
  {
    "objectID": "bioconductor.html#more-than-software",
    "href": "bioconductor.html#more-than-software",
    "title": "Bioconductor",
    "section": "More than software",
    "text": "More than software\n\nTraining programs & workshops\nCommunity support\nConferences\n\n\n\n\nBioconductor is more than software.\nWorldwide community of bioinformaticians; both users and developers.\n\nEuropean Bioconductor conference is organized this year in Turku, Finland."
  },
  {
    "objectID": "bioconductor.html#community-is-the-key",
    "href": "bioconductor.html#community-is-the-key",
    "title": "Bioconductor",
    "section": "Community is the key",
    "text": "Community is the key\n\nTraining programs & workshops\nCommunity support\nConferences\n\n\n\n\nBioconductor is more than software.\nWorldwide community of bioinformaticians; both users and developers.\n\nEuropean Bioconductor conference is organized this year in Turku, Finland."
  },
  {
    "objectID": "intro.html#learning-goals",
    "href": "intro.html#learning-goals",
    "title": "Introduction",
    "section": "Learning goals",
    "text": "Learning goals\nAfter the course, you will know how to:\n\nAnalyze microbiome data using the Bioconductor‚Äôs SummarizedExperiment ecosystem\nImplement reproducible workflows\nExplore documentation & tools via the OMA book\n\n\nBy the end of the course, you‚Äôll be able to apply SE-based methods, create meaningful plots, and know where to go for further learning."
  },
  {
    "objectID": "intro.html#code-of-conduct",
    "href": "intro.html#code-of-conduct",
    "title": "Introduction",
    "section": "Code of Conduct",
    "text": "Code of Conduct\nBioconductor community values an open approach to science that promotes\n\nsharing of ideas, code, software and expertise\ncollaboration\ndiversity and inclusivity\na kind and welcoming environment\ncommunity contributions\n\nBy participating in this community, you agree not to engage in behavior contrary to these values at any Bioconductor-sponsored event or electronic communication channel.\nFor the full CoC, see: https://bioconductor.github.io/bioc_coc_multilingual"
  },
  {
    "objectID": "intro.html#learning-goals-for-today",
    "href": "intro.html#learning-goals-for-today",
    "title": "Introduction",
    "section": "Learning goals for today",
    "text": "Learning goals for today\nBroader context and practical skills on:\n\nBioconductor ecosystem\nData containers: understanding SummarizedExperiment\nImporting data: how to get your data imported in R"
  },
  {
    "objectID": "intro.html#questions-1",
    "href": "intro.html#questions-1",
    "title": "Introduction",
    "section": "Questions?",
    "text": "Questions?\n\n\n\nMoreno-Indias et al.¬†(2021) Statistical and Machine Learning Techniques in Human Microbiome Studies: Contemporary Challenges and Solutions. Frontiers in Microbiology."
  },
  {
    "objectID": "bioconductor.html#other-dimensions",
    "href": "bioconductor.html#other-dimensions",
    "title": "Bioconductor",
    "section": "Other dimensions",
    "text": "Other dimensions\n\n\nCollaborative development\n- 50,000+ papers in PubMed\n- software & data repository\n- tutorials & documentation\n- bioinformatics peer support"
  },
  {
    "objectID": "bioconductor.html#other-elements",
    "href": "bioconductor.html#other-elements",
    "title": "Bioconductor",
    "section": "Other elements",
    "text": "Other elements\n\n\nCollaborative development\n- software & data repository\n- tutorials & documentation\n- community support\n- 50,000+ citations in PubMed"
  },
  {
    "objectID": "bioconductor.html#collaborative-development-1",
    "href": "bioconductor.html#collaborative-development-1",
    "title": "Bioconductor",
    "section": "Collaborative development",
    "text": "Collaborative development"
  },
  {
    "objectID": "bioconductor.html#cultures-of-open-collaboration",
    "href": "bioconductor.html#cultures-of-open-collaboration",
    "title": "Bioconductor",
    "section": "Cultures of open collaboration",
    "text": "Cultures of open collaboration"
  },
  {
    "objectID": "bioconductor.html#open-data-science-ecosystems",
    "href": "bioconductor.html#open-data-science-ecosystems",
    "title": "Bioconductor",
    "section": "Open data science ecosystems",
    "text": "Open data science ecosystems"
  },
  {
    "objectID": "bioconductor.html#rbioc-community",
    "href": "bioconductor.html#rbioc-community",
    "title": "Bioconductor",
    "section": "R/Bioc community",
    "text": "R/Bioc community\nBioconductor conferences:\n\nNorth America\nAsia\nEurope\n(Africa)\n(South America)"
  },
  {
    "objectID": "bioconductor.html#collaborative-development",
    "href": "bioconductor.html#collaborative-development",
    "title": "Bioconductor",
    "section": "Collaborative development",
    "text": "Collaborative development\n- software & data repository\n- tutorials & documentation\n- community support\n- 50,000+ citations in PubMed"
  },
  {
    "objectID": "bioconductor.html#open-microbiome-data-science-ecosystems",
    "href": "bioconductor.html#open-microbiome-data-science-ecosystems",
    "title": "Bioconductor",
    "section": "Open (microbiome) data science ecosystems",
    "text": "Open (microbiome) data science ecosystems"
  },
  {
    "objectID": "bioconductor.html#recommended-reading",
    "href": "bioconductor.html#recommended-reading",
    "title": "Bioconductor",
    "section": "Recommended reading",
    "text": "Recommended reading\nModern Statistics for Modern Biology (Susan Holmes & Wolfgang Huber, Cambridge University Press 2019): https://www.huber.embl.de/msmb/"
  },
  {
    "objectID": "bioconductor.html#next-data-containers",
    "href": "bioconductor.html#next-data-containers",
    "title": "Bioconductor",
    "section": "Next: Data containers",
    "text": "Next: Data containers\n\nData containers"
  },
  {
    "objectID": "bioconductor.html#benefits-1",
    "href": "bioconductor.html#benefits-1",
    "title": "Bioconductor",
    "section": "Benefits",
    "text": "Benefits\n\nTightly linked with broader Bioconductor ecosystem\nImproved scalability\nImproved multi-table integration\n\n\n\nWe use same data format as broader Bioconductor ecosystem. Some of you might know phyloseq. That was specifically designed for 16S amplicon data, and is not supported outside its ecosystem. Moreover, microbiome data science is nowadays more than sequencing data, it links different fields from metabolomics to genomics. Same data format allows us to use methods from different fields.\nThe ecosystem is more scalable; speed and memory wise than phyloseq and its more efficient alternative, speedyseq. It is not uncommon anymore that there are tens of thousands of samples and features so we need efficient software to run these big datasets.\nThis ecosystem allows us to link multiple tables together, facilitating multi-omics integration by supporting management of this kind of complex datasets."
  },
  {
    "objectID": "transformation.html#intuition",
    "href": "transformation.html#intuition",
    "title": "Transformation",
    "section": "Intuition",
    "text": "Intuition\n\nThis is the idea behind CLR transformation."
  },
  {
    "objectID": "transformation.html#intuition-1",
    "href": "transformation.html#intuition-1",
    "title": "Transformation",
    "section": "Intuition",
    "text": "Intuition\n\nValues dependent, only ratios matter\n\n\nWhen we want to compare values in compositional data, only ratios make sense."
  },
  {
    "objectID": "transformation.html#intuition-2",
    "href": "transformation.html#intuition-2",
    "title": "Transformation",
    "section": "Intuition",
    "text": "Intuition\n\nValues dependent, only ratios matter\nStandard statistics rely on subtraction and distance\n\n\nHowever, most statistical tests rely that substraction make sense. How to make ratios subtractions?"
  },
  {
    "objectID": "transformation.html#intuition-3",
    "href": "transformation.html#intuition-3",
    "title": "Transformation",
    "section": "Intuition",
    "text": "Intuition\n\nValues dependent, only ratios matter\nStandard statistics rely on subtraction and distance\n\n\\[\n\\frac{x}{y} = a-b\n\\]\n\nThis is the situation."
  },
  {
    "objectID": "transformation.html#intuition-4",
    "href": "transformation.html#intuition-4",
    "title": "Transformation",
    "section": "Intuition",
    "text": "Intuition\n\nValues dependent, only ratios matter\nStandard statistics rely on subtraction and distance\n\nUse log-scale\n\n\n\\[\nlog(\\frac{x}{y}) = log(x) - log(y)\n\\]\n\nTaking the log turns multiplicative relationships (ratios) into additive ones (differences), making subtraction meaningful."
  },
  {
    "objectID": "transformation.html#intuition-5",
    "href": "transformation.html#intuition-5",
    "title": "Transformation",
    "section": "Intuition",
    "text": "Intuition\n\nValues dependent, only ratios matter\nStandard statistics rely on subtraction and distance\n\nUse log-scale\n\nLibrary sizes are arbitrary\n\n\nLibrary sizes are arbitrary. This means that the scale of values are arbitrary. How to remove the effect of them?"
  },
  {
    "objectID": "transformation.html#intuition-6",
    "href": "transformation.html#intuition-6",
    "title": "Transformation",
    "section": "Intuition",
    "text": "Intuition\n\nValues dependent, only ratios matter\nStandard statistics rely on subtraction and distance\n\nUse log-scale\n\nLibrary sizes are arbitrary\n\nCenter the data\n\n\n\nBy centering the data, i.e., removing the mean."
  },
  {
    "objectID": "transformation.html#intuition-7",
    "href": "transformation.html#intuition-7",
    "title": "Transformation",
    "section": "Intuition",
    "text": "Intuition\n\nValues dependent, only ratios matter\nStandard statistics rely on subtraction and distance\n\nUse log-scale\n\nLibrary sizes are arbitrary\n\nCenter the data\n\n\n\nCLR converts compositional data into a format where subtraction, distances, and correlations make sense. This solves both the dependency and library size issues."
  },
  {
    "objectID": "transformation.html#centering",
    "href": "transformation.html#centering",
    "title": "Transformation",
    "section": "Centering",
    "text": "Centering\n\\[\n\\text{CLR}(x_i) \\;=\\; \\log\\left(\\frac{x_i}{g(x)}\\right) \\\\[2mm]\n= \\log(x_i) - \\log(g(x)) \\\\[2mm]\n\\]\n\nWe remove the mean.\nWhy we remove geometric mean?"
  },
  {
    "objectID": "transformation.html#correct-transformation-depends-on",
    "href": "transformation.html#correct-transformation-depends-on",
    "title": "Transformation",
    "section": "Correct transformation depends on",
    "text": "Correct transformation depends on\n\nYour research question\nOn the analysis method\n\n\nUse the simplest justified approach that works\n\n\nThere is increasing amount of benchmarking literature on this. We combine them to online book.\nThe ‚Äúbest‚Äù transformation depends on what you want to learn and the statistical methods you plan to use. Often, a simple, well-justified approach works well in practice."
  },
  {
    "objectID": "alpha_diversity.html#applications",
    "href": "alpha_diversity.html#applications",
    "title": "Alpha diversity",
    "section": "Applications",
    "text": "Applications\nAlpha diversity, ageing and body-mass index across the life span.\nData: HITChip Atlas, Lahti et al.¬†Nat Comm 2014"
  },
  {
    "objectID": "alpha_diversity.html#hills-diversity-index",
    "href": "alpha_diversity.html#hills-diversity-index",
    "title": "Alpha diversity",
    "section": "Hill‚Äôs diversity index",
    "text": "Hill‚Äôs diversity index"
  },
  {
    "objectID": "alpha_diversity.html#simpsons-diversity",
    "href": "alpha_diversity.html#simpsons-diversity",
    "title": "Alpha diversity",
    "section": "Simpson‚Äôs diversity?",
    "text": "Simpson‚Äôs diversity?\nHowever, the original Simpson index \\(\\lambda\\) decreases with diversity. Therefore we typically use:\n\nInverse Simpson: \\(1 / \\lambda\\) (the most common case of Simpson‚Äôs diversity)\nReciprocal Simpson (or Gini-Simpson): \\(1 - \\lambda\\)"
  },
  {
    "objectID": "alpha_diversity.html#simpsons-index-dominance",
    "href": "alpha_diversity.html#simpsons-index-dominance",
    "title": "Alpha diversity",
    "section": "Simpson‚Äôs index (dominance)",
    "text": "Simpson‚Äôs index (dominance)\nSimpson index \\(\\lambda\\) measures how likely two randomly picked individuals represent the same species.\n\\[\\lambda = \\sum_{i=1}^{R} p_i^2\\]\nwhere:\n\n\\(p_i\\) = relative abundance of species \\(i\\)\n\n\\(R\\) = richness, or the number of unique species\n\n\nSimpson‚Äôs index measures how evenly individuals are distributed into different types (or species).\n\nIt is easy to interpret and always ranges between 0 and 1.\nThis formula assumes large sample size and sampling with replacement. Variations exist for small sample size and sampling without replacement (see e.g.¬†Wikipedia). These can be useful in low-diversity environments (to check mia/vegan versions)"
  },
  {
    "objectID": "alpha_diversity.html#counting-the-species-richness-and-diversity",
    "href": "alpha_diversity.html#counting-the-species-richness-and-diversity",
    "title": "Alpha diversity",
    "section": "Counting the species richness and diversity",
    "text": "Counting the species richness and diversity"
  },
  {
    "objectID": "alpha_diversity.html#counting-richness-and-evenness",
    "href": "alpha_diversity.html#counting-richness-and-evenness",
    "title": "Alpha diversity",
    "section": "Counting richness and evenness",
    "text": "Counting richness and evenness"
  },
  {
    "objectID": "alpha_diversity.html#pielous-evenness",
    "href": "alpha_diversity.html#pielous-evenness",
    "title": "Alpha diversity",
    "section": "Pielou‚Äôs evenness",
    "text": "Pielou‚Äôs evenness\n\\[ E = \\frac{Shannon\\ diversity}{ln(Obs.\\ Richness)} = \\frac{H}{ln(S)}\\]"
  },
  {
    "objectID": "alpha_diversity.html#hills-diversity-a-unifying-concept",
    "href": "alpha_diversity.html#hills-diversity-a-unifying-concept",
    "title": "Alpha diversity",
    "section": "Hill‚Äôs diversity: a unifying concept",
    "text": "Hill‚Äôs diversity: a unifying concept\nTrue diversity, the effective number of types, refers to the number of equally abundant types needed for the average proportional abundance of the types to equal what is observed in the dataset of interest.\n\\[\n^qD = \\frac{1}{M_{q-1}} = (\\sum_{i=1}^R p_i^q)^\\frac{1}{1-q},\n\\]\nwhere (again)\n\n\\(p_i\\) is relative abundance of species \\(i\\),\n\\(R\\) is the richness (number of species)\n\\(q^D\\) is the Hill number of order \\(q\\), the effective number of species\nDenominator \\(M_{q-1}\\): average relative abundance, with weighted generalized mean with exponent \\(q ‚àí 1\\).\n\n\nIn M, q = 0 corresponds to the weighted harmonic mean,\nq = 1 to the weighted geometric mean, and\nq = 2 to the weighted arithmetic mean.[7]\nAs q approaches infinity, the weighted generalized mean with exponent q ‚àí 1 approaches the maximum p_i value, which is the proportional abundance of the most abundant species in the dataset."
  },
  {
    "objectID": "alpha_diversity.html#faith-phylogenetic-diversity",
    "href": "alpha_diversity.html#faith-phylogenetic-diversity",
    "title": "Alpha diversity",
    "section": "Faith phylogenetic diversity",
    "text": "Faith phylogenetic diversity\nFaith index incorporates phylogenetic differences (tree) to diversity: sum of branch lengths in a phylogenetic tree that connects all species present in a sample."
  },
  {
    "objectID": "alpha_diversity.html#hills-diversity-a-unifying-concept-1",
    "href": "alpha_diversity.html#hills-diversity-a-unifying-concept-1",
    "title": "Alpha diversity",
    "section": "Hill‚Äôs diversity: a unifying concept",
    "text": "Hill‚Äôs diversity: a unifying concept\nCommon diversity measures are special cases:\n\n\\(q = 0\\): Observed Richness\n\\(q = 1\\): Shannon diversity\n\\(q = 2\\): (Inverse) Simpson diversity\n\\(q ‚â† 1\\): Renyi entropy\n\\(q = \\infty\\): \\(\\frac{1}{{^{\\infty}}D}\\): Berger-Parker index"
  },
  {
    "objectID": "alpha_diversity.html#berger-parker-dominance",
    "href": "alpha_diversity.html#berger-parker-dominance",
    "title": "Alpha diversity",
    "section": "Berger-Parker dominance",
    "text": "Berger-Parker dominance\nMaximum relative abundance in the sample; or relative abundance \\(p_i\\) of the most abundant type.\n\\[\nmax_i (p_i)\n\\]"
  },
  {
    "objectID": "alpha_diversity.html#simpsons-dominance-index",
    "href": "alpha_diversity.html#simpsons-dominance-index",
    "title": "Alpha diversity",
    "section": "Simpson‚Äôs dominance index",
    "text": "Simpson‚Äôs dominance index\nSimpson index \\(\\lambda\\) measures how likely two randomly picked individuals represent the same species.\n\\[\\lambda = \\sum_{i=1}^{R} p_i^2\\]\nwhere:\n\n\\(p_i\\) = relative abundance of species \\(i\\)\n\n\\(R\\) = richness, or the number of unique species\n\n\nSimpson‚Äôs index measures how evenly individuals are distributed into different types (or species).\n\nIt is easy to interpret and always ranges between 0 and 1.\nThis formula assumes large sample size and sampling with replacement. Variations exist for small sample size and sampling without replacement (see e.g.¬†Wikipedia). These can be useful in low-diversity environments (to check mia/vegan versions)"
  },
  {
    "objectID": "alpha_diversity.html#fast-diversity-fast-implementation",
    "href": "alpha_diversity.html#fast-diversity-fast-implementation",
    "title": "Alpha diversity",
    "section": "Fast diversity: fast implementation",
    "text": "Fast diversity: fast implementation\nEfficient computation of Faith‚Äôs phylogenetic diversity with applications in characterizing microbiomes. Armstrong et al.¬†(2021), Genome Research.\nTreeSE: gray versus phyloseq (black)"
  },
  {
    "objectID": "alpha_diversity.html#faith-phylogenetic-diversity-1",
    "href": "alpha_diversity.html#faith-phylogenetic-diversity-1",
    "title": "Alpha diversity",
    "section": "Faith phylogenetic diversity",
    "text": "Faith phylogenetic diversity\nPhylogenetic diversity provides increased statistical power to differentiate age groups in shotgun metagenomics but not in 16S rRNA sequencing.\n\nArmstrong et al.¬†(2021), Genome Research."
  },
  {
    "objectID": "alpha_diversity.html#faith-phylogenetic-diversity-2",
    "href": "alpha_diversity.html#faith-phylogenetic-diversity-2",
    "title": "Alpha diversity",
    "section": "Faith phylogenetic diversity",
    "text": "Faith phylogenetic diversity\nPhylogenetic tree colored by age-group log of the likelihood ratio of older to younger adults per node.\n\n(A) Distribution of Faith‚Äôs PD by age group on the full data set.\n(B) Web of Life (WoL) phylogenetic tree, branches colored by log likelihood of old vs.¬†young adults (FINRISK cohort).\nArmstrong et al.¬†(2021), Genome Research.\n\ninner circle: colored by the log of likelihood ratio of older adults compared to younger adults in the tips of the tree.\nouter circle: colored by the phylum of the taxon represented by each tree tip. Red ellipses mark two clades enriched for samples from older individuals."
  },
  {
    "objectID": "alpha_diversity.html#finite-sampling",
    "href": "alpha_diversity.html#finite-sampling",
    "title": "Alpha diversity",
    "section": "Finite sampling",
    "text": "Finite sampling\n\ngithub.com/mblstamps/stamps2019"
  },
  {
    "objectID": "alpha_diversity.html#detecting-species-in-metagenomics",
    "href": "alpha_diversity.html#detecting-species-in-metagenomics",
    "title": "Alpha diversity",
    "section": "Detecting species in metagenomics",
    "text": "Detecting species in metagenomics"
  },
  {
    "objectID": "alpha_diversity.html#on-reference-databases",
    "href": "alpha_diversity.html#on-reference-databases",
    "title": "Alpha diversity",
    "section": "On reference databases",
    "text": "On reference databases"
  },
  {
    "objectID": "alpha_diversity.html#applications-1",
    "href": "alpha_diversity.html#applications-1",
    "title": "Alpha diversity",
    "section": "Applications",
    "text": "Applications"
  },
  {
    "objectID": "alpha_diversity.html#metacommunity-and-total-richness",
    "href": "alpha_diversity.html#metacommunity-and-total-richness",
    "title": "Alpha diversity",
    "section": "Metacommunity and total richness",
    "text": "Metacommunity and total richness\n\n\nHigh-quality reference genomes are required for functional characterization and taxonomic assignment of the human gut microbiota.\nUnified Human Gastrointestinal Genome (UHGG): 4,644 gut prokaryotes (&gt;70% lack cultured representatives) 204,938 nonredundant genomes\nEncode &gt;170 million protein sequences, collated into Unified Human Gastrointestinal Protein (UHGP) catalog.\nUHGP more than doubles the number of gut proteins in comparison to those present in the Integrated Gene Catalog. 40% of the UHGP lack functional annotations\nIntraspecies genomic variation analyses revealed a large reservoir of accessory genes and single-nucleotide variants, many of which are specific to individual human populations.\nThe UHGG and UHGP collections enable studies linking genotypes to phenotypes in the human gut microbiome."
  },
  {
    "objectID": "alpha_diversity.html#fast-faith-implementation",
    "href": "alpha_diversity.html#fast-faith-implementation",
    "title": "Alpha diversity",
    "section": "Fast Faith implementation",
    "text": "Fast Faith implementation\nEfficient computation of Faith‚Äôs phylogenetic diversity with applications in characterizing microbiomes. Armstrong et al.¬†(2021), Genome Research.\nTreeSE: gray versus phyloseq (black)"
  }
]