---
title: "Bioconductor"
format:
  revealjs:
    self-contained: true
    slide-number: true
    preview-links: auto
    logo: images/mia_logo.png
    footer: <https://microbiome.github.io/>
date: last-modified
date-format: full
bibliography: references.bib
---

## Bioconductor

- Community-driven open-source project

1. Training programs & workshops
2. Conferences & community support
3. Bioinformatics software

![](images/bioconductor_logo_rgb.jpg){fig-alt="Bioconductor logo." fig-align="right" width=10%}

::: {.notes}

1. Bioconductor is more than software.
2. Worldwide community of bioinformaticians; both users and developers.

:::

## Software

- ~2,300 R packages
- Review, testing, documentation

```{r}
#| label: bioc_packages
#| eval: true

# Get packages and info based on their BiocViews
pkgs <- BiocPkgTools::biocPkgList()
#
pkgs[["SE"]] <- sapply(pkgs$Depends, function(x) any(grepl("summarizedexperiment", x, ignore.case = TRUE)) )
fields <- sapply(pkgs$biocViews, function(x){
    field <- "Other"
    if( any(grepl("genomic|genetic|gene|genom|DNA", x, ignore.case = TRUE)) ){
        field <- "Genomics"
    }
    if( any(grepl("proteomics|protein", x, ignore.case = TRUE)) ){
        field <- "Proteomics"
    }
    if( any(grepl("metabolomics|metabolome|metabolite|Lipidom|massspectro", x, ignore.case = TRUE)) ){
        field <- "Metabolomics"
    }
    if( any(grepl("transcripto|RNA-seq|RNA", x, ignore.case = TRUE)) ){
        field <- "Transcriptomics"
    }
    if( any(grepl("immuno", x, ignore.case = TRUE)) ){
        field <- "Immunology"
    }
    if( any(grepl("cytom", x, ignore.case = TRUE)) ){
        field <- "Cytometrics"
    }
    if( any(grepl("microarray|chip", x, ignore.case = TRUE)) ){
        field <- "Microarray"
    }
    if( any(grepl("single-cell|singlecell", x, ignore.case = TRUE)) ){
        field <- "Single-cell"
    }
    if( any(grepl("metagenom|microbiome|16S|microbiota|amplicon|shotgun|microb|metatranscript|metametabolo|metaproteo", x, ignore.case = TRUE)) ){
        field <- "Microbiome"
    }
    return(field)
})
pkgs[["Field"]] <- fields
pkgs[pkgs[["Package"]] %in% c("mia", "miaViz", "miaSim", "iSEEtree", "HoloFoodR", "MGnifyR"), "Field"] <- "Microbiome"
# Get download stats 
df <- BiocPkgTools::biocDownloadStats()
# Subset to include only packages which BiocView we have
df <- df[df$Package %in% pkgs$Package, ]
# submitted <- BiocPkgTools::firstInBioc(df)
# df <- df[df$Package %in% pkgs$Package, ] # Take into account only current packages
pkgs <- pkgs[, c("Package", "SE", "Field")]
# Get table that shows which package is available in each date
dates <- df$Date |> unique()
dates <- dates[ dates < lubridate::floor_date(Sys.time(), "month") ]
available <- lapply(dates, function(date){
    temp <- df[df[["Date"]] == date, ]
    temp <- temp[match(unique(df$Package), temp$Package), ]
    temp <- temp[["Nb_of_distinct_IPs"]] > 0 | temp[["Nb_of_downloads"]] > 0
    temp[is.na(temp)] <- FALSE
    temp <- as.numeric(temp)
    return(temp)
})
available <- do.call(cbind, available) |> as.data.frame()
rownames(available) <- unique(df$Package)
colnames(available) <- dates
#
ind <- pkgs[match(unique(df$Package), pkgs$Package), "Field"][[1]]
pkgs_date <- rowsum(available, group = ind)
# Put into long format
library(tidyverse)
pkgs_date <- pkgs_date %>%
    rownames_to_column("Field") %>%
    pivot_longer(
        cols = colnames(pkgs_date)[ !colnames(pkgs_date) %in% c("Field")], 
        names_to = "Date",
        values_to = "N"
    )
pkgs_date[["Date"]] <- as.Date(pkgs_date[["Date"]])

# Create a plot that shows number of package through date
p1 <- ggplot(pkgs_date, aes(x = Date, y = N, fill = Field)) +
    geom_area() + theme_classic() + scale_fill_brewer(palette = "Paired") +
    labs(x = "Year", y = "Number of packages") +
    scale_x_date(
        expand = c(0, 0),
        limits = c(min(pkgs_date[["Date"]]), max(pkgs_date[["Date"]]))
    ) +
  theme_classic(base_size = 18)
p1
```

::: {.notes}

1. Popularity has grown.
2. Broad range of fields (microbiome is rather small, but steadily raising ~ 50 packages)
3. Over 2,300 R packages
4. Not limited to R, but R has been the main language. Activity in Python and Julia.
5. Special abut Bioconductor is the rather strict requirements which ensure the high-quality.

Review process when submitting (novel, relevant, works as it should be, documentation is sufficient)
Testing is done automatically (daily).
Software must be accessible. --> documentation must be good

:::

## Microbiome Analysis (mia)

```{r}
#| label: mia_stats
#| eval: true

perc <- BiocPkgTools::pkgDownloadRank("mia")
perc <- paste0(perc, "%")
```

- Microbiome data science ecosystem
- "Downstream", statistical analysis
- `r BiocStyle::Biocpkg("mia")` package top `r if(exists("perc")) perc else "*ERROR*"` Bioconductor downloads

<div style="text-align: right;">
  <img src="images/BioconductorSticker1.png" alt="Bioconductor sticker" width="200" style="margin-left: 10px;">
  <img src="images/mia_logo.png" alt="mia logo" width="200">
</div>

::: {.notes}

1. Within Bioconductor, we have developed microbiome data science ecosystem
2. For downstream analysis
3. Aligned and tightly linked with broader Bioconductor ecosystem

:::

## Related ecosystems

```{r}
#| label: microbiome_bioconductor
#| fig-width: 15
#| fig-height: 6

library(ggplot2)
library(ggrepel)

# Timeline data
timeline_data <- data.frame(
    year = c(2012, 2015, 2017, 2019),
    event = c(
        "phyloseq\nMcMurdie and Holmes, 2013",
        "SummarizedExperiment\nHuber et al., 2015",
        "SingleCellExperiment\nAmezquita et al., 2020", 
        "TreeSummarizedExperiment\nHuang et al., 2021"
    )
)

# Create a single polygon for the entire arrow (rectangle + arrowhead)
arrow_data <- data.frame(
    x = c(2021, 2024.5, 2024.5, 2025, 2024.5, 2024.5, 2021),
    y = c(-0.14, -0.14, -0.16, -0.10, -0.04, -0.06, -0.06)
)

ggplot(timeline_data, aes(x = year, y = 0)) +
    # Base timeline
    annotate(
        "segment", x = 2011, xend = 2025, y = 0, yend = 0,
        arrow = arrow(length = unit(0.4, "cm"), type = "closed"),
        linewidth = 1.5, color = "gray40"
        ) +
    
    # Timeline points and segments
    geom_point(size = 5, color = "#2C3E50") +
    
    # Repelled labels
    geom_label_repel(
        aes(
          label = event),
          direction = "y",
          nudge_y = 0.02,
          box.padding = 0.4,
          point.padding = 0.5,
          size = 5,
          fontface = "bold",
          color = "#34495E",
          segment.color = "gray60"
        ) +
    
    # mia: draw arrow-box from 2021 to 2025
    geom_polygon(
        data = arrow_data,
        mapping = aes(x = x, y = y),
        fill = "white", color = "black", linewidth = 0.8
        ) +
    annotate(
        "text", x = 2022.75, y = -0.10,
        label = "OMA\n(Borman et al., 2025)",
        size = 5, fontface = "bold", color = "black", lineheight = 1.1
        ) +
    
    # Final theming
    scale_x_continuous(
        breaks = c(timeline_data$year, 2021, 2025),
        limits = c(2010, 2025)
        ) +
    scale_y_continuous(limits = c(-0.25, 0.3)) +
    theme_minimal(base_size = 15) +
    theme(
        axis.title = element_blank(),
        axis.text.y = element_blank(),
        axis.text.x = element_text(size = 16),
        axis.ticks = element_blank(),
        panel.grid = element_blank(),
        legend.position = "none",
        plot.title = element_text(face = "bold", size = 16, hjust = 0.5)
    )
```

::: {.notes}

Over the years, several approaches to data organization have been developed.
One of the first widely adopted data containers in microbiome research was
`r BiocStyle::Biocpkg("phyloseq")` [@McMurdie2013], designed for 16S amplicon
sequencing data. However, it has limitations, particularly in linking multiple
experiments and ensuring interoperability between tools in Bioconductor.

`r BiocStyle::Biocpkg("SummarizedExperiment")` (SE) [@Huber2015], on the other
hand, was introduced as a general-purpose container for biological data and has
become the most widely used format within the Bioconductor ecosystem. It has
since been extended to more specialized formats, including
`r BiocStyle::Biocpkg("SingleCellExperiment")` [@Amezquita2020] for single-cell
data and
`r BiocStyle::Biocpkg("TreeSummarizedExperiment")` (TreeSE) [@Huang2021], which
is tailored for microbiome datasets.

:::

## Benefits

1. Tightly linked with broader Bioconductor ecosystem
2. Improved scalability
3. Improved multi-table integration

::: {.notes}

1. We use same data format as broader Bioconductor ecosystem. Some of you might know phyloseq. That was specifically designed for 16S amplicon data, and is not supported outside its ecosystem. Moreover, microbiome data science is nowadays more than sequencing data, it links different fields from metabolomics to genomics. Same data format allows us to use
methods from different fields.
2. The ecosystem is more scalable; speed and memory wise than phyloseq and its more efficient alternative, speedyseq. It is not uncommon anymore that there are tens of thousands of samples and features so we need efficient software to run these big datasets.
3. This ecosystem allows us to link multiple tables together, facilitating multi-omics integration by supporting management of this kind of complex datasets.

:::

## Community-driven ecosystem of tools {.smaller}

::: columns
::: {.column width="70%"}

- `r BiocStyle::Biocpkg("mia")` (Data analysis)
- `r BiocStyle::Biocpkg("miaViz")` (Visualization)
- `r BiocStyle::Biocpkg("miaSim")` (Simulation)
- [miaTime](https://github.com/microbiome/miaTime) (Time series analysis)
- `r BiocStyle::Biocpkg("miaDash")` (Graphical user interface)
- `r BiocStyle::Biocpkg("iSEETree")` (Interactive visualization)
- [Expanded by independent developers](https://microbiome.github.io/OMA/docs/devel/pages/miaverse.html#sec-packages)

:::

::: {.column width="30%"}

![](https://raw.githubusercontent.com/microbiome/mia/refs/heads/devel/man/figures/mia_logo.png){fig-alt="mia logo." width=20%}
![](https://raw.githubusercontent.com/EBI-Metagenomics/MGnifyR/refs/heads/devel/man/figures/mgnifyr_logo.png){fig-alt="MGnifyR logo." width=20%}
![](https://raw.githubusercontent.com/EBI-Metagenomics/HoloFoodR/refs/heads/devel/man/figures/holofoodr_logo.png){fig-alt="HoloFoodR logo." width=20%}
![](https://raw.githubusercontent.com/Bioconductor/BiocStickers/refs/heads/devel/iSEE/iSEE.png){fig-alt="iSEE logo." width=20%}
![](https://raw.githubusercontent.com/Bioconductor/BiocStickers/refs/heads/devel/MultiAssayExperiment/MultiAssayExperiment.png){fig-alt="MAE logo." width=20%}
![](https://raw.githubusercontent.com/Bioconductor/BiocStickers/refs/heads/devel/SummarizedExperiment/SummarizedExperiment.png){fig-alt="SE logo." width=20%}
![](https://raw.githubusercontent.com/Bioconductor/BiocStickers/refs/heads/devel/SingleCellExperiment/SingleCellExperiment.png){fig-alt="SCE logo." width=20%}
![](https://raw.githubusercontent.com/Bioconductor/BiocStickers/refs/heads/devel/scater/scater.png){fig-alt="scater logo." width=20%}
![](https://pbs.twimg.com/media/FDNU5KgWYAcnU8w.jpg){fig-alt="benchdamic logo." width=20%}
![](https://netcomi.de/logo.png){fig-alt="netcomi logo." width=20%}
![](https://raw.githubusercontent.com/statdivlab/radEmu/refs/heads/main/man/figures/logo.png){fig-alt="radEmu logo." width=20%}
![](https://mikelove.github.io/assets/DESeq2.png){fig-alt="DESeq2 logo." width=20%}
![](https://avatars.githubusercontent.com/u/18152373?s=280&v=4){fig-alt="Biobakery logo." width=20%}
![](https://raw.githubusercontent.com/thomazbastiaanssen/anansi/refs/heads/devel/man/figures/anansi_hex.png){fig-alt="anansi logo." width=20%}
:::

:::

::: {.notes}

Ecosystem of packages developed by the community. mia provides the basic operations in microbiome data analysis. miaViz has the methods for visualization.

Developed by independent developers who have started to support the ecosystem.

:::

## Data containers

- [Data containers](https://microbiome.github.io/outreach/data_containers.html){target="_blank"}

## References
